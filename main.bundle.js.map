{"version":3,"sources":["webpack:///./src/app/game/_entity.ts","webpack:///./src/app/game/weapon.ts","webpack:///./src async","webpack:///./src/main.ts","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/app/game/bullet.ts","webpack:///./src/app/game/entity.ts","webpack:///./src/app/game/game.ts","webpack:///./src/app/game/map.ts","webpack:///./src/app/game/player.ts","webpack:///./src/app/game/visibilitySprite.ts","webpack:///./src/app/game/zombie.ts","webpack:///./src/app/loader/default-request-options.service.ts","webpack:///./src/app/loader/game.service.ts","webpack:///./src/app/phaser/delayedAnimation.ts","webpack:///./src/app/phaser/engine.ts","webpack:///./src/app/phaser/pool.ts","webpack:///./src/app/phaser/spawnable.ts","webpack:///./src/environments/environment.ts","webpack:///./src/app/app.component.css","webpack:///./src/app/app.component.html"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["import { Entity, EntityType } from 'app/game/entity'\r\nimport { Weapon } from 'app/game/weapon'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { Square } from 'app/game/map'\r\nimport { Game } from 'app/game/game'\r\nimport * as _ from 'lodash'\r\n\r\n\r\nexport class _Entity implements Entity {\r\n\r\n\r\n    game: Game\r\n    angle: number = 90\r\n\r\n    static idcount: number = 0\r\n    visionRange: number\r\n    pathMap: Map<string, any[]>\r\n    id: number\r\n    engine: Engine\r\n    teamId: number\r\n    team: Array<Entity>\r\n    sprite: Phaser.Sprite\r\n    attackRange: number\r\n    type = EntityType.human\r\n    position: Phaser.Point\r\n    maxAction: number\r\n    currentAction: number\r\n    weapons: Array<Weapon> = []\r\n    selectedWeaponIndex: number = 0\r\n    armor: number\r\n    pv: number\r\n    maxArmor: number\r\n    maxPv: number\r\n    mouvementRange: number\r\n    square: Square\r\n    targetSquare: Square\r\n    coverDetection: number\r\n    visibleSquares: Array<Square>\r\n    updateAccessibleTiles: boolean\r\n    mapLastUpdate: number\r\n    isMasked: boolean\r\n\r\n\r\n    constructor(engine: Engine, position: Phaser.Point) {\r\n        this.engine = engine;\r\n        this.position = position;\r\n        this.id = _Entity.idcount++;\r\n    }\r\n\r\n    public maskEntity(): _Entity {\r\n        this.isMasked = true;\r\n        this.setAnimation();\r\n        return this;\r\n    }\r\n    public unmaskEntity(): _Entity {\r\n        this.isMasked = false;\r\n        this.setAnimation();\r\n        return this;\r\n    }\r\n\r\n    listener() {\r\n        //this.targeted(this);\r\n    }\r\n\r\n    private setAnimation() {\r\n        let prefix = this.isMasked ? 'masked-' : '',\r\n            angle = this.angle,\r\n            animation = '';\r\n        if (angle > 0) {\r\n            if (angle < 45) {\r\n                animation = prefix + 'right'\r\n            } else if (angle < 135) {\r\n                animation = prefix + 'down'\r\n            } else {\r\n                animation = prefix + 'left';\r\n            }\r\n        } else {\r\n            angle = Math.abs(angle);\r\n            if (angle < 45) {\r\n                animation = prefix + 'right'\r\n            } else if (angle < 135) {\r\n                animation = prefix + 'up'\r\n            } else {\r\n                animation = prefix + 'left';\r\n            }\r\n        }\r\n\r\n        console.log('direction', animation);\r\n        this.engine.lookTo(this.sprite, animation);\r\n    }\r\n\r\n    private updateDirection(sourcePosition: Phaser.Point, targetPosition: Phaser.Point) {\r\n        let angle = Math.atan2(targetPosition.y - sourcePosition.y, targetPosition.x - sourcePosition.x) * (180 / Math.PI);\r\n\r\n        this.angle = angle;\r\n\r\n        this.isMasked = this.square.mask;\r\n\r\n        this.setAnimation();\r\n    }\r\n\r\n    public finishMoving(): _Entity {\r\n        this.sprite.play('stand-down');\r\n        return this;\r\n    }\r\n\r\n\r\n    public attack(target: Entity): _Entity {\r\n\r\n        this.updateDirection(this.position, target.position);\r\n\r\n        return this;\r\n    }\r\n    public move(targetPosition: Phaser.Point, callback: () => void): _Entity {\r\n\r\n        this.updateDirection(this.position, targetPosition);\r\n\r\n        this.position = targetPosition;\r\n        this.engine.moveTo(this.sprite, this.position.x, this.position.y, callback);\r\n        return this;\r\n    }\r\n\r\n    public touched(sourceEntity: Entity, damage: number): _Entity {\r\n        return this;\r\n    }\r\n    public die(sourceEntity: Entity): Entity {\r\n\r\n        this.sprite.alive = false\r\n        this.sprite.visible = false\r\n        this.sprite.animations.stop()\r\n        let index = _(this.team).remove(['id', this.id]).value();\r\n        this.game.setDead(this, sourceEntity)\r\n        return this;\r\n    }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/_entity.ts","import { Entity } from 'app/game/entity'\r\nimport { GameMap } from 'app/game/map'\r\nimport { Game } from 'app/game/game'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { Square } from 'app/game/map'\r\nimport { Bullet } from 'app/game/bullet'\r\nimport * as _ from 'lodash';\r\n\r\n// prevoir une compétence pour utiliser les machines guns debout\r\n\r\nexport enum WEAPONS {\r\n    NINEMM,\r\n    SHOOTGUN,\r\n    AR15,\r\n    //Ruger No. 1 Varminter K1-V-BBZ\r\n    RUGER_K1,\r\n    BLASER_R8,\r\n    PIPE,\r\n    AXE,\r\n    PUNCH,\r\n    BAT,\r\n    NAILBAT,\r\n    KNIFE,\r\n    KATANA,\r\n    HAND_GRENADE\r\n}\r\n\r\nexport interface fireReturn {\r\n}\r\n\r\nexport interface WeaponData {\r\n    name: string\r\n    minRange: number\r\n    maxRange: number\r\n    minDamage: number\r\n    maxDamage: number\r\n    precision: number\r\n    criticalChance: number\r\n    maxAmmo: number\r\n    currentAmmo: number\r\n    jammedChance: number\r\n    maxEntityByBullet: number\r\n    // si setté, la balle perdra en dommage par case parcouru\r\n    damageReduction?: number\r\n    // si supérieur à 0, on calcul un arbre de dispersion et on applique la précision sur chaqune des cibles.\r\n    spreadAngle: number\r\n    projectileByShot: number\r\n    // pour les armes à explosion\r\n    damageRange: number\r\n    damageRangeReduction?: number\r\n    isRanged: boolean\r\n}\r\n\r\nexport interface Weapon {\r\n    data: WeaponData\r\n\r\n    fire(sourceEntity: Entity, targetEntity: Entity): void\r\n    reload(): void\r\n}\r\n\r\nclass WeaponImpl implements Weapon {\r\n    bulletSpeed: number;\r\n\r\n    private rnd: Phaser.RandomDataGenerator;\r\n    private isJammed: boolean = false;\r\n    private bulletGroup: Phaser.Group;\r\n\r\n    constructor(public data: WeaponData, public game: Game, key) {\r\n        this.rnd = this.game.engine.phaserGame.rnd;\r\n        this.bulletGroup = this.game.engine.addGroup(data.name);\r\n\r\n        for (var i = 0; i < 64; i++) {\r\n            this.bulletGroup.add(new Bullet(this.game.engine.phaserGame, 'bullet6'), true);\r\n        }\r\n    }\r\n\r\n    public fire(sourceEntity: Entity, targetEntity: Entity): void {\r\n\r\n        this.bulletSpeed = 700;\r\n        if (this.isJammed) {\r\n            return;\r\n        }\r\n\r\n        if (this.data.isRanged) {\r\n            if (this.data.currentAmmo > 0) {\r\n                this.data.currentAmmo--\r\n            }\r\n            else {\r\n                //you should reload\r\n                return;\r\n            }\r\n        }\r\n\r\n        if (this.checkJam()) {\r\n            return;\r\n        }\r\n\r\n        if (this.data.spreadAngle == 0) {\r\n            let touchedEntity = this.shootSingleBullet(sourceEntity, targetEntity);\r\n            var x = sourceEntity.position.x + 10;\r\n            var y = sourceEntity.position.y + 10;\r\n            let currentDistance = 0;\r\n\r\n\r\n            if (!touchedEntity) {\r\n                currentDistance = this.data.maxRange * 32;\r\n            } else {\r\n                let dx = Math.abs(x - touchedEntity.position.x);\r\n                let dy = Math.abs(y - touchedEntity.position.y);\r\n                currentDistance = (dx + dy);\r\n            }\r\n            let baseAngle = -Math.atan2(targetEntity.square.y - sourceEntity.square.y, targetEntity.square.x - sourceEntity.square.x) * (180 / Math.PI);\r\n            console.log('fire bullet ', baseAngle);\r\n            this.bulletGroup.getFirstExists(false).fire(x, y, -baseAngle, this.bulletSpeed, 0, 0, currentDistance);\r\n        } else {\r\n\r\n            this.shootMultyBullet(sourceEntity, targetEntity);\r\n        }\r\n\r\n\r\n    }\r\n\r\n    private shootSingleBullet(sourceEntity: Entity, targetEntity: Entity) {\r\n        let damageModifier = 1//plus tard on aura les modifieurs source et cible\r\n        if (!this.checkHitSuccess()) {\r\n            return;\r\n        }\r\n\r\n        if (this.checkCriticalSuccess()) {\r\n            damageModifier = 2;\r\n        }\r\n        let damage = damageModifier * this.getDamage();\r\n        targetEntity.touched(sourceEntity, damage);\r\n        return targetEntity;\r\n    }\r\n\r\n    private shootMultyBullet(sourceEntity: Entity, targetEntity: Entity) {\r\n\r\n        // check les trajectoires des balles\r\n        // angle par rapport à la cible\r\n        // l'angle est à placer sur la ligne des x2. Puis on divise l'angle pour chacune des balles\r\n        // on calcul des lignes de BresenhamLine pour checker le coup sur la première entité rencontrée (plus tard on verra pour celles derrière)\r\n        let sourceSquare = sourceEntity.square,\r\n            // les y sont inversés, il faut donc inverser l'angle.\r\n            baseAngle = -Math.atan2(targetEntity.square.y - sourceSquare.y, targetEntity.square.x - sourceSquare.x) * (180 / Math.PI),\r\n            startAngle = baseAngle + (this.data.spreadAngle / 2),\r\n            angleStep = this.data.spreadAngle / this.data.projectileByShot;\r\n\r\n\r\n        _.times(this.data.projectileByShot, index => {\r\n            this.processSingleBullet(sourceEntity, sourceSquare, startAngle - (index * angleStep));\r\n        });\r\n    }\r\n\r\n    static RADIANS_FACTOR = (Math.PI / 180);\r\n\r\n    private toRadians(angle) {\r\n        return angle * WeaponImpl.RADIANS_FACTOR;\r\n    }\r\n\r\n\r\n    //todo enregistrer tous les dommages d'une action et résoudre ça à la fin.\r\n    private processSingleBullet(sourceEntity: Entity, sourceSquare, currentAngle: number) {\r\n        let targetX = Math.round(Math.cos(this.toRadians(currentAngle)) * this.data.maxRange) + sourceSquare.x,\r\n            targetY = -Math.round(Math.sin(this.toRadians(currentAngle)) * this.data.maxRange) + sourceSquare.y,\r\n            targetSquare = this.game.map.getSquare(targetX, targetY),\r\n            lineOfSight = this.game.map.BresenhamLine(sourceSquare, targetSquare),\r\n            entitiesOnLineOfSight = _(lineOfSight)\r\n                .tail()\r\n                .filter((square) => square.entity).map(square => square.entity)\r\n                .value(),\r\n            lastPositionTouched: Phaser.Point = null,\r\n            entityTouched = 0;\r\n\r\n        console.log('bullet', currentAngle, targetX, targetY);\r\n\r\n        entitiesOnLineOfSight.forEach(entity => {\r\n            let damageModifier = 1//plus tard on aura les modifieurs source et cible\r\n            if (entityTouched >= this.data.maxEntityByBullet) {\r\n                return\r\n            }\r\n\r\n            if (!this.checkHitSuccess()) {\r\n                return;\r\n            } else {\r\n                entityTouched++;\r\n            }\r\n            if (this.checkCriticalSuccess()) {\r\n                damageModifier = 2;\r\n            }\r\n            let damage = damageModifier * this.getDamage();\r\n            entity.touched(sourceEntity, damage);\r\n            lastPositionTouched = entity.position\r\n        });\r\n\r\n\r\n        console.log('fire bullet ', currentAngle);\r\n        var x = sourceEntity.position.x + 10;\r\n        var y = sourceEntity.position.y + 10;\r\n        let currentDistance = 0;\r\n\r\n\r\n        if (!lastPositionTouched) {\r\n            currentDistance = this.data.maxRange * 32;\r\n        } else {\r\n            let dx = Math.abs(x - lastPositionTouched.x);\r\n            let dy = Math.abs(y - lastPositionTouched.y);\r\n            currentDistance = (dx + dy);\r\n        }\r\n\r\n        this.bulletGroup.getFirstExists(false).fire(x, y, -currentAngle, this.bulletSpeed, 0, 0, currentDistance);\r\n    }\r\n\r\n    public reload(): void {\r\n        this.data.currentAmmo = this.data.maxAmmo;\r\n    }\r\n\r\n    private checkJam(): boolean {\r\n        if (this.checkRollSuccess(this.data.jammedChance)) {\r\n            this.isJammed = true;\r\n        }\r\n        return this.isJammed;\r\n    }\r\n\r\n    private getDamage(): number {\r\n        return this.rnd.integerInRange(this.data.minDamage, this.data.maxDamage);\r\n    }\r\n\r\n    private checkCriticalSuccess(): boolean {\r\n        return this.checkRollSuccess(this.data.criticalChance);\r\n    }\r\n\r\n    private checkHitSuccess(): boolean {\r\n        return this.checkRollSuccess(this.data.precision);\r\n    }\r\n\r\n    private checkRollSuccess(chance): boolean {\r\n        let roll = this.rnd.realInRange(0, 100);\r\n        return roll <= chance;\r\n    }\r\n}\r\n\r\nexport class WeaponPool {\r\n\r\n    static add(weapons: WEAPONS, game: Game): Weapon {\r\n        switch (weapons) {\r\n            case WEAPONS.NINEMM:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'NINEMM',\r\n                    minRange: 0,\r\n                    maxRange: 9,\r\n                    minDamage: 1,\r\n                    maxDamage: 3,\r\n                    precision: 65,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.SHOOTGUN:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'SHOOTGUN',\r\n                    minRange: 0,\r\n                    maxRange: 5,\r\n                    minDamage: 1,\r\n                    maxDamage: 2,\r\n                    precision: 80,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 4,\r\n                    currentAmmo: 4,\r\n                    spreadAngle: 30,\r\n                    damageRange: 0,\r\n                    projectileByShot: 6,\r\n                    isRanged: false\r\n                }, game, 'bullet8');\r\n            case WEAPONS.PIPE:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'PIPE',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.AXE:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'AXE',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.PUNCH:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'PUNCH',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.BAT:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'BAT',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.NAILBAT:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'NAILBAT',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.KNIFE:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'KNIFE',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n            case WEAPONS.KATANA:\r\n\r\n                return new WeaponImpl({\r\n                    name: 'KATANA',\r\n                    minRange: 0,\r\n                    maxRange: 0,\r\n                    minDamage: 0,\r\n                    maxDamage: 0,\r\n                    precision: 0,\r\n                    criticalChance: 10,\r\n                    jammedChance: 5,\r\n                    maxEntityByBullet: 1,\r\n                    maxAmmo: 6,\r\n                    currentAmmo: 6,\r\n                    spreadAngle: 0,\r\n                    damageRange: 0,\r\n                    projectileByShot: 1,\r\n                    isRanged: false\r\n                }, game, 'bullet6');\r\n\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/weapon.ts","function webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 294;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src async\n// module id = 294\n// module chunks = 1","\nimport { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","import { AfterContentInit, Component, ElementRef } from '@angular/core';\r\nimport { GameService } from 'app/loader/game.service';\r\nimport GameMap from 'app/game-map';\r\nimport GameSprites from 'app/game-sprites';\r\nimport { GameSprite } from 'app/game-sprite';\r\nimport GameTile from 'app/game-tile';\r\nimport GameCamera from 'app/game-camera';\r\nimport { Game } from 'app/game/game';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: './app.component.html',\r\n  providers: [GameService],\r\n  styleUrls: ['./app.component.css']\r\n})\r\nexport class AppComponent implements AfterContentInit {\r\n  private game: Game;\r\n  private camera: GameCamera;\r\n  private map: GameMap;\r\n  private sprites: GameSprites;\r\n\r\n  public constructor(private elementRef: ElementRef, private gameService: GameService) { }\r\n\r\n\r\n  public ngAfterContentInit() {\r\n    this.game = new Game(this.gameService);\r\n  }\r\n\r\n  private refresh(): void {\r\n    this.map.draw();\r\n  }\r\n\r\n  private getBackgroundCanvas(): HTMLCanvasElement {\r\n    var canvasBackground: HTMLCanvasElement = this.elementRef.nativeElement.querySelector('.game__canvas__background');\r\n\r\n    canvasBackground.width = 1280;\r\n    canvasBackground.height = 720;\r\n\r\n    return canvasBackground;\r\n  }\r\n  private getSpritesCanvas(): HTMLCanvasElement {\r\n    var canvasSprites: HTMLCanvasElement = this.elementRef.nativeElement.querySelector('.game__canvas__sprites');\r\n\r\n    canvasSprites.width = 1280;\r\n    canvasSprites.height = 720;\r\n\r\n    return canvasSprites;\r\n  }\r\n\r\n  private getMapCtx(mapCanvas: HTMLCanvasElement): CanvasRenderingContext2D {\r\n    var ctx: CanvasRenderingContext2D = mapCanvas.getContext('2d');\r\n    ctx.webkitImageSmoothingEnabled = false;\r\n    ctx.mozImageSmoothingEnabled = false;\r\n    return ctx;\r\n  }\r\n}\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HttpModule, JsonpModule } from '@angular/http'; \r\nimport { requestOptionsProvider }   from './loader/default-request-options.service'; \r\n\r\nimport { AppComponent } from './app.component';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    AppComponent\r\n  ],\r\n  imports: [\r\n    BrowserModule,\r\n    FormsModule,\r\n    HttpModule\r\n  ],\r\n  providers: [ requestOptionsProvider ], \r\n  bootstrap: [AppComponent]\r\n})\r\nexport class AppModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","export class Bullet extends Phaser.Sprite {\r\n    scaleSpeed: number;\r\n    tracking: boolean;\r\n\r\n    distance: number\r\n    sx: number\r\n    sy: number\r\n\r\n    constructor(game: Phaser.Game, key: string) {\r\n        super(game, 0, 0, key);\r\n        this.texture.baseTexture.scaleMode = PIXI.scaleModes.NEAREST;\r\n\r\n        this.anchor.set(0.5);\r\n\r\n        this.checkWorldBounds = true;\r\n        this.outOfBoundsKill = true;\r\n        this.exists = false;\r\n        this.visible = false;\r\n\r\n        this.tracking = false;\r\n        this.scaleSpeed = 0;\r\n    }\r\n\r\n    fire(x: number, y: number, angle: number, speed: number, gx: number, gy: number, distance: number) {\r\n        gx = gx || 0;\r\n        gy = gy || 0;\r\n\r\n        this.reset(x, y);\r\n        this.scale.set(1);\r\n        this.distance = distance;\r\n\r\n        this.sx = x\r\n        this.sy = y\r\n\r\n        this.game.physics.arcade.velocityFromAngle(angle, speed, this.body.velocity);\r\n\r\n        this.angle = angle;\r\n\r\n        this.body.gravity.set(gx, gy);\r\n        this.exists = true;\r\n        this.visible = true;\r\n    }\r\n\r\n    update() {\r\n        if (!this.exists) {\r\n            return\r\n        }\r\n\r\n        let dx = Math.abs(this.sx - this.x);\r\n        let dy = Math.abs(this.sy - this.y);\r\n        let currentDistance = (dx + dy)\r\n\r\n        console.log('currentDistance', currentDistance)\r\n\r\n        if (currentDistance >= this.distance) {\r\n            this.exists = false;\r\n            this.visible = false;\r\n        }\r\n\r\n        if (this.tracking) {\r\n            this.rotation = Math.atan2(this.body.velocity.y, this.body.velocity.x);\r\n        }\r\n\r\n        if (this.scaleSpeed > 0) {\r\n            this.scale.x += this.scaleSpeed;\r\n            this.scale.y += this.scaleSpeed;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/bullet.ts","import { Entity } from 'app/game/entity'\r\nimport { Weapon } from 'app/game/weapon'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { Square } from 'app/game/map'\r\nimport { Game } from 'app/game/game'\r\n\r\nexport interface Entity {\r\n    game:Game\r\n    maxAction: number\r\n    currentAction:number\r\n    weapons:Array<Weapon>\r\n    selectedWeaponIndex:number\r\n    armor:number\r\n    pv:number\r\n    maxArmor:number\r\n    maxPv:number\r\n    mouvementRange:number\r\n    visionRange:number\r\n    attackRange: number\r\n    position:Phaser.Point\r\n    type:EntityType\r\n    sprite: Phaser.Sprite\r\n    pathMap:Map<string, any[]>\r\n    teamId:number\r\n    engine:Engine\r\n    id:number\r\n    square:Square\r\n    targetSquare:Square\r\n    coverDetection:number\r\n    visibleSquares:Array<Square>\r\n    updateAccessibleTiles:boolean\r\n    mapLastUpdate:number\r\n    isMasked:boolean\r\n\r\n    touched(sourceEntity: Entity, damage:number):Entity\r\n    die(sourceEntity: Entity):Entity\r\n    attack(target: Entity):Entity\r\n    move(targetPosition:Phaser.Point, callback:()=> void):Entity\r\n    finishMoving():Entity\r\n    maskEntity():Entity\r\n    unmaskEntity():Entity\r\n}\r\nexport enum EntityType {\r\n    human,\r\n    zombie\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/entity.ts","import { Player } from 'app/game/player'\r\nimport { Ennemy } from 'app/game/ennemy'\r\nimport { Zombie } from 'app/game/zombie'\r\nimport { GameMap } from 'app/game/map'\r\nimport { Entity, EntityType } from 'app/game/entity'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { GameService } from 'app/loader/game.service'\r\nimport { Weapon, WeaponPool, WEAPONS } from 'app/game/weapon'\r\nimport { Square } from 'app/game/map'\r\n\r\n// a faire des zombie cadavres !!\r\n// compétence S-link\r\n// pendant le tour de l'IA, on désactive le clic\r\n//pousser des trucs pour se cacher des zomblards\r\n//le vent pour l'odeur ...\r\n// faire des packs de zombies (à agreger par rapport à la distance)\r\n//global revolver\r\nexport class Game {\r\n    public map: GameMap;\r\n    public engine: Engine;\r\n\r\n    private ticking: boolean;\r\n    private playerTeam: Array<Player>;\r\n    private ennemyTeam: Array<Ennemy>;\r\n    private zombieTeam: Array<Zombie>;\r\n    private turn: number;\r\n    private currentIndex: number;\r\n    private currentEntity: Entity;\r\n    private currentTeam: Array<Entity>;\r\n    private currentTeamId: number;\r\n\r\n    private zombieTeamId: number = 0;\r\n    private playerTeamId: number = 1;\r\n    private ennemyTeamId: number = 2;\r\n\r\n    constructor(gameService: GameService) {\r\n        this.map = new GameMap('zombie');\r\n        this.engine = new Engine(this.map.getName(), gameService);\r\n        this.engine.observable.subscribe(\r\n            next => this.setUpTeams(),\r\n            error => console.error('error loading map'),\r\n            () => console.log('c\\'est fini'));\r\n    }\r\n\r\n    private setUpTeams() {\r\n        let engine = this.engine,\r\n            targetCallback = (z) => this.targeted(z),\r\n            map = this.map;\r\n        this.turn = 0;\r\n        this.map.setEngine(engine);\r\n        map.preparePathCalculator();\r\n        this.playerTeam = new Array<Player>();\r\n        this.ennemyTeam = new Array<Ennemy>();\r\n        this.zombieTeam = new Array<Zombie>();\r\n\r\n        this.addPlayer(5, 3);\r\n        this.addPlayer(6, 3)\r\n            .addWeapon(WEAPONS.SHOOTGUN)\r\n            .selectWeapon(1);\r\n\r\n        this.addZombieAt(5, 7);\r\n        this.addZombieAt(4, 8);\r\n        this.addZombieAt(6, 8);\r\n        this.addZombieAt(5, 8);\r\n\r\n        this.addZombieAt(28, 17);\r\n        this.addZombieAt(29, 17);\r\n        this.addZombieAt(30, 17);\r\n        this.addZombieAt(31, 17);\r\n        this.addZombieAt(36, 12);\r\n        this.addZombieAt(36, 10);\r\n        this.addZombieAt(37, 10);\r\n        this.addZombieAt(38, 10);\r\n        this.addZombieAt(21, 21);\r\n\r\n\r\n        this.currentIndex = -1;\r\n        this.currentTeamId = this.playerTeamId;\r\n        this.currentTeam = this.playerTeam;\r\n        this.updateAllVisibilities();\r\n        this.nextCharacter();\r\n        this.showAccessibleTilesByPlayer();\r\n        engine.bindClick(point => this.clickOn(point));\r\n        engine.bindOver(point => this.overOn(point), point => this.overOff(point));\r\n\r\n    }\r\n\r\n    private addZombieAt(x, y): Zombie {\r\n        let zombie = Zombie.popZombie(this.engine, this.map.getPointAtSquare(x, y), this.zombieTeamId, this.zombieTeam, this);\r\n        this.map.putEntityAtPoint(zombie);\r\n        return zombie;\r\n    }\r\n    private addPlayer(x, y): Player {\r\n        let player = Player.popPlayer(this.engine, this.map.getPointAtSquare(x, y), this.playerTeamId, this.playerTeam, this);\r\n        this.map.putEntityAtPoint(player);\r\n        return player;\r\n    }\r\n\r\n    public nextAction() {\r\n        this.currentEntity.currentAction++;\r\n        if (this.currentEntity.currentAction >= this.currentEntity.maxAction) {\r\n            this.nextCharacter();\r\n        }\r\n        console.time(this.currentTeamId + '/' + this.currentEntity.id + ' nextAction');\r\n        this.engine.removeAllVisibleTiles();\r\n        this.updateVisibleSquaresOfEntity(this.currentEntity);\r\n        this.prepareAction();\r\n    }\r\n    public nextCharacter() {\r\n        if (this.currentIndex >= this.currentTeam.length - 1) {\r\n            this.nextTeam();\r\n            return;\r\n        }\r\n        this.currentIndex = this.currentIndex + 1;\r\n        this.currentEntity = this.currentTeam[this.currentIndex];\r\n        this.currentEntity.currentAction = 0;\r\n        this.engine.setGlowPosition(this.currentEntity.position);\r\n        this.engine.removeAllAccessibleTiles();\r\n        this.engine.removeAllVisibleTiles();\r\n    }\r\n\r\n\r\n    public nextTeam() {\r\n        this.currentIndex = -1;\r\n\r\n        if (this.currentTeamId === this.playerTeamId) {\r\n            this.currentTeamId = this.zombieTeamId;\r\n            this.currentTeam = this.zombieTeam;\r\n        } else if (this.currentTeamId === this.zombieTeamId) {\r\n            this.currentTeamId = this.playerTeamId;\r\n            this.currentTeam = this.playerTeam;\r\n        }\r\n        this.nextCharacter();\r\n    }\r\n\r\n    // une entité a été ciblé\r\n    public targeted(target: Entity) {\r\n        if (this.currentEntity.id === target.id) {\r\n            console.log('it\\'s me');\r\n            return;\r\n        }\r\n\r\n        if (this.IsEntityInCurrentTeam(target)) {\r\n            this.helpTeamMate(target);\r\n        } else {\r\n            this.currentEntity.attack(target);\r\n        }\r\n    }\r\n\r\n    private updateVisibleSquaresOfEntity(entity: Entity) {\r\n\r\n        console.time('updateVisibleSquaresOfEntity');\r\n        this.map.setVisibileSquares(entity);\r\n        console.timeEnd(\"updateVisibleSquaresOfEntity\");\r\n    }\r\n\r\n    private updateAllVisibilities() {\r\n        this.playerTeam.forEach(p => {\r\n            this.map.setVisibileSquares(p, true);\r\n        })\r\n        this.zombieTeam.forEach(z => {\r\n            this.map.setVisibileSquares(z, true);\r\n        })\r\n    }\r\n    public IsEntityInCurrentTeam(target: Entity) {\r\n        return target.teamId === this.currentTeamId;\r\n    }\r\n\r\n    public helpTeamMate(target: Entity) {\r\n        console.log(this.currentEntity + ' helps ' + target);\r\n    }\r\n    private overOff(target: Phaser.Point) {\r\n        if (this.currentTeamId !== this.playerTeamId || this.ticking) {\r\n            return\r\n        }\r\n\r\n        // clean visibletiles\r\n        if (this.entityFocused) {\r\n            //let points = this.entityFocused.visibleSquares.map(s => this.map.getPointAtSquare(s.x, s.y)).map(tile => tile.x + ':' + tile.y);\r\n            this.engine.removeAllVisibleTiles();\r\n        }\r\n        this.entityFocused = null;\r\n    }\r\n\r\n    private entityFocused: Entity\r\n\r\n    private overOn(target: Phaser.Point) {\r\n        if (this.currentTeamId !== this.playerTeamId || this.ticking) {\r\n            return\r\n        }\r\n        let square = this.map.getSquareAtPoint(target);\r\n        console.log('over', square);\r\n\r\n        if (square.entity) {\r\n            this.entityFocused = square.entity;\r\n            let points: Array<Phaser.Point> = square.entity.visibleSquares.map(s => this.map.getPointAtSquare(s.x, s.y));\r\n            console.time('addVisibleTiles');\r\n            this.engine.addVisibleTiles([], points);\r\n\r\n            console.timeEnd('addVisibleTiles');\r\n        }\r\n    }\r\n\r\n\r\n    private clickOn(target: Phaser.Point) {\r\n\r\n        if (this.currentTeamId !== this.playerTeamId || this.ticking) {\r\n            return\r\n        }\r\n        let square = this.map.getSquareAtPoint(target);\r\n\r\n        // targeting something\r\n        if (square.entity) {\r\n            this.currentEntity.updateAccessibleTiles = false;\r\n            this.targeted(square.entity);\r\n            this.ticking = true;\r\n            this.nextAction();\r\n            this.ticking = false;\r\n        }\r\n        else {\r\n            // moving to\r\n            if (!this.map.canEntityGoToTarget(this.currentEntity, target)) {\r\n                return;\r\n            }\r\n\r\n\r\n            this.map.moveEntityAtPoint(this.currentEntity, target,\r\n                () => {\r\n                    this.currentEntity.updateAccessibleTiles = true;\r\n                    this.currentEntity.targetSquare = this.map.getSquareAtPoint(target);\r\n                    this.showAccessibleTilesByPlayer();\r\n                    this.nextAction()\r\n                    this.ticking = false;\r\n                }, (error) => {\r\n                    console.log('sorry', error);\r\n                    this.ticking = false;\r\n                });\r\n\r\n            this.ticking = true;\r\n        }\r\n    }\r\n\r\n    private prepareAction() {\r\n\r\n        if (this.currentTeamId === this.zombieTeamId) {\r\n            console.time(this.currentTeamId + '/' + this.currentEntity.id + ' zombie play');\r\n            this.zombieTeam[this.currentIndex].play(() => {\r\n                    console.timeEnd(this.currentTeamId + '/' + this.currentEntity.id + ' zombie play');\r\n                    console.timeEnd(this.currentTeamId + '/' + this.currentEntity.id + ' nextAction');\r\n                    console.time(this.currentTeamId + '/' + this.currentEntity.id + ' timeout');\r\n                    setTimeout(\r\n                        () => {\r\n                            console.timeEnd(this.currentTeamId + '/' + this.currentEntity.id + ' timeout');\r\n                            this.nextAction();\r\n                        }, 300);\r\n                }\r\n            );\r\n        } else {\r\n            if (this.currentEntity.currentAction === 0) {\r\n                this.showAccessibleTilesByPlayer();\r\n                console.timeEnd(this.currentTeamId + '/' + this.currentEntity.id + ' nextAction');\r\n            }\r\n        }\r\n    }\r\n\r\n    private showAccessibleTilesByPlayer() {\r\n        this.currentEntity.updateAccessibleTiles = true;\r\n        this.map.setAccessibleTilesByEntity(this.currentEntity);\r\n        this.currentEntity.updateAccessibleTiles = false;\r\n        this.showAccessibleTiles(this.currentEntity);\r\n    }\r\n\r\n    /**\r\n     * show accessible tile for current entity\r\n     */\r\n    private showAccessibleTiles(entity: Entity) {\r\n        let positions: Array<Phaser.Point> = new Array();\r\n        entity.pathMap.forEach((path, key) => {\r\n            let splittedKey = key.split(':'),\r\n                squareX = Number(splittedKey[0]),\r\n                squareY = Number(splittedKey[1]);\r\n            positions.push(this.map.getPointAtSquare(squareX, squareY));\r\n        });\r\n        this.engine.addAccessibleTiles(positions);\r\n    }\r\n\r\n    public getPathTo(start: Square, end: Square, range: number, useDiagonal?:boolean): Array<any> {\r\n        return this.map.getPathTo(start, end, range, useDiagonal);\r\n    }\r\n\r\n    \r\n    public getSquare(x:number, y:number): Square {\r\n        return this.map.getSquare(x, y);\r\n    }\r\n\r\n    public setDead(dead:Entity, by:Entity){\r\n\r\n        this.engine.showText(by.position.x, by.position.y, ' has killed ' + dead.id);\r\n\r\n        this.map.setDead(dead);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/game.ts","import { Entity, EntityType } from 'app/game/entity';\r\nimport { Engine } from 'app/phaser/engine';\r\nimport * as _ from 'lodash';\r\ndeclare let Graph: any;\r\ndeclare let astar: any;\r\n\r\nconst tilesize = 32;\r\n\r\nexport class GameMap {\r\n    private entities: Array<Entity> = new Array();\r\n    private grid: Array<Array<number>>;\r\n    private size: MapSize;\r\n    public squares: Map<string, Square> = new Map<string, Square>()\r\n    public engine: Engine;\r\n    constructor(private name: string) { }\r\n\r\n    setEngine(engine: Engine) {\r\n        this.engine = engine;\r\n    }\r\n\r\n    public setVisibileSquares(entity: Entity, force?: boolean) {\r\n        if (!entity.updateAccessibleTiles && !force) {\r\n            return;\r\n        }\r\n        console.time(entity.id + '=>setVisibileSquares');\r\n        let square = entity.square,\r\n            x: number = square.x,\r\n            y: number = square.y,\r\n            perimetre: Array<Square> = this.getSquareInRange(x, y, entity.visionRange),\r\n            visibleSquares: Array<Square> = new Array();\r\n\r\n        // TODO comme pour les déplacements, mettre en cache les case déja visibles.\r\n\r\n        perimetre.forEach(currentSquare => {\r\n            let line = this.BresenhamLine(square, currentSquare),\r\n                squareJustBefore = line.length > 2 ? line[1] : null;\r\n\r\n            // si la case justeavant masque la case, on ne l'ajoute pas\r\n            if (squareJustBefore && entity.coverDetection < squareJustBefore.cover) {\r\n                return;\r\n            }\r\n\r\n            let canSeeSquare = line.reduce((canSee, currentSquare) => {\r\n                // si l'entité ne peut pas voir au dela de l case, elle ne pourra pas voir plus loin\r\n                if (currentSquare.cover === 100) {\r\n                    return false;\r\n                }\r\n\r\n\r\n                return canSee;\r\n            }, true);\r\n            if (canSeeSquare) {\r\n                visibleSquares.push(currentSquare);\r\n            }\r\n        });\r\n        entity.visibleSquares = visibleSquares;\r\n        console.timeEnd(entity.id + '=>setVisibileSquares');\r\n    }\r\n\r\n    private getSquareInRange(xm, ym, r): Array<Square> {\r\n        //console.time('getSquareInRange');\r\n        /* bottom left to top right */\r\n        let x = -r, y = 0, err = 2 - 2 * r,\r\n            perimetre: Array<Square> = new Array(),\r\n            squaresMap: Map<string, Square> = new Map(),\r\n            squaresInRange: Array<Square> = new Array(),\r\n            size = this.size,\r\n            isBetween = this.isBetween,\r\n            squares = this.squares;\r\n\r\n        do {\r\n            /*   I. Quadrant +x +y */\r\n            addToSquares((xm - x), (ym + y));\r\n            /*  II. Quadrant -x +y */\r\n            addToSquares((xm - y), (ym - x));\r\n            /* III. Quadrant -x -y */\r\n            addToSquares((xm + x), (ym - y));\r\n            /*  IV. Quadrant +x -y */\r\n            addToSquares((xm + y), (ym + x));\r\n\r\n            r = err;\r\n            if (r <= y) {\r\n                /* y step */\r\n                err += ++y * 2 + 1;\r\n            }\r\n            if (r > x || err > y) {\r\n                /* x step */\r\n                err += ++x * 2 + 1;\r\n            }\r\n        } while (x < 0);\r\n\r\n        squaresMap.forEach(s => squaresInRange.push(s));\r\n        //console.timeEnd(\"getSquareInRange\");\r\n        return squaresInRange;\r\n\r\n        function addToSquares(x, y) {\r\n            let step = x\r\n\r\n\r\n            if (x < xm) {\r\n                for (step; step <= xm; step++) {\r\n                    addSquareToRange();\r\n                }\r\n            } else {\r\n                for (step; step >= xm; step--) {\r\n                    addSquareToRange();\r\n                }\r\n            }\r\n\r\n            function addSquareToRange() {\r\n                let key = step + ':' + y,\r\n                    square = squares.get(key);\r\n\r\n                if (square && (step >= 0 && y >= 0)) {\r\n                    square.data.distanceFrom = step;\r\n                    squaresMap.set(key, squares.get(key));\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // si derrière une case à 50% de cover il est invisible.\r\n    // si il se trouve\r\n    public getVisibleEntitiedByEntity(entity: Entity): Array<Entity> {\r\n        let square = entity.square,\r\n            x: number = square.x,\r\n            y: number = square.y,\r\n            xMin = Math.max(x - entity.visionRange, 0),\r\n            xMax = Math.min(x + entity.visionRange, this.size.width),\r\n            yMin = Math.max(y - entity.visionRange, 0),\r\n            yMax = Math.min(y + entity.visionRange, this.size.height),\r\n            filter = (e: Entity) => {\r\n                return this.isBetween(e.square.x, xMin, xMax) && this.isBetween(e.square.y, yMin, yMax);\r\n            };\r\n\r\n        let visibleEntities = this.entities.filter(filter).filter(e => this.isEntityCanSeeEntityB(entity, e));\r\n        return visibleEntities;\r\n    }\r\n\r\n    private isBetween(value, min, max) {\r\n        return min <= value && value <= max;\r\n    }\r\n\r\n    private isEntityCanSeeEntityB(a: Entity, b: Entity): boolean {\r\n        let squares = this.BresenhamLine(a.square, b.square);\r\n\r\n        return squares.reduce((canSee, currentSquare) => {\r\n\r\n            // si l'entité ne peut pas voir au dela de al case, elle ne pourra pas voir plus loin\r\n            if (a.coverDetection < currentSquare.cover) {\r\n                return false;\r\n            }\r\n            return canSee;\r\n        }, true);\r\n\r\n    }\r\n\r\n    // Returns the list of points from (x0, y0) to (x1, y1)\r\n    public BresenhamLine(start: Square, end: Square): Array<Square> {\r\n        let x0: number = start.x,\r\n            y0: number = start.y,\r\n            x1: number = end.x,\r\n            y1: number = end.y,\r\n            result: Array<Square> = new Array(),\r\n            steep: boolean = Math.abs(y1 - y0) > Math.abs(x1 - x0);\r\n        // Optimization: it would be preferable to calculate in\r\n        // advance the size of \"result\" and to use a fixed-size array\r\n        // instead of a list.\r\n\r\n        if (steep) {\r\n            //Swap(ref x0, ref y0);\r\n            x0 = start.y;\r\n            y0 = start.x;\r\n            //Swap(ref x1, ref y1);\r\n            x1 = end.y;\r\n            y1 = end.x;\r\n\r\n        }\r\n        if (x0 > x1) {\r\n            //Swap(ref x0, ref x1);\r\n            let tempX = x0;\r\n            x0 = x1;\r\n            x1 = tempX\r\n            //Swap(ref y0, ref y1);\r\n            let tempY = y0;\r\n            y0 = y1;\r\n            y1 = tempY;\r\n        }\r\n\r\n        let deltax: number = x1 - x0,\r\n            deltay: number = Math.abs(y1 - y0),\r\n            error: number = 0,\r\n            ystep: number = y0 < y1 ? 1 : -1,\r\n            y: number = y0;\r\n\r\n        for (let x = x0; x <= x1; x++) {\r\n            let point = new Phaser.Point();\r\n            if (steep) {\r\n                point.x = y;\r\n                point.y = x;\r\n            }\r\n            else {\r\n                point.x = x;\r\n                point.y = y;\r\n            }\r\n            let key = point.x + ':' + point.y;\r\n\r\n            result.push(this.squares.get(key));\r\n            error += deltay;\r\n            if (2 * error >= deltax) {\r\n                y += ystep;\r\n                error -= deltax;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n\r\n    public preparePathCalculator() {\r\n        let tileMap: Phaser.Tilemap = this.engine.map;\r\n        this.size = {\r\n            width: tileMap.width / 2,\r\n            height: tileMap.height / 2\r\n        }\r\n\r\n        this.grid = new Array();\r\n        _.times(this.size.height, rowIndex => {\r\n            let row: Array<number> = new Array();\r\n            _.times(this.size.width, columnIndex => {\r\n                let tilePosition: Phaser.Point = this.getPointAtSquare(columnIndex, rowIndex),\r\n                    gridStatus: number = this.engine.isPositionCollidable(tilePosition) ? 1 : 0,\r\n                    tileCover: number = this.engine.getPositionCover(tilePosition),\r\n                    mask: boolean = this.engine.getPositionMask(tilePosition);\r\n                row.push(gridStatus);\r\n\r\n                let key = columnIndex + ':' + rowIndex;\r\n                if (!this.squares.has(key)) {\r\n                    this.squares.set(key, {\r\n                        entity: null,\r\n                        x: columnIndex,\r\n                        y: rowIndex,\r\n                        cover: tileCover,\r\n                        data: {},\r\n                        mask: mask\r\n                    })\r\n                }\r\n            });\r\n            this.grid.push(row);\r\n        })\r\n        // this.easyStar.enableCornerCutting();\r\n        //this.easyStar.enableDiagonals();\r\n    }\r\n\r\n    public putEntityAtPoint(entity: Entity): Square {\r\n\r\n        let position = new Phaser.Point;\r\n        position.x = entity.position.x;\r\n        position.y = entity.position.y;\r\n        let square = this.getSquareAtPoint(position);\r\n\r\n        if (square.entity) {\r\n            throw new Error(\"entity.already.here\");\r\n        }\r\n        this.grid[square.y][square.x] += 10;\r\n\r\n        square.entity = entity;\r\n        entity.square = square;\r\n        entity.targetSquare = square;\r\n\r\n        square.mask ? entity.maskEntity() : entity.unmaskEntity();\r\n\r\n        this.entities.push(entity)\r\n\r\n        return square;\r\n    }\r\n\r\n    public setAccessibleTilesByEntity(entity: Entity) {\r\n        //mapLastUpdate\r\n        entity.mapLastUpdate = this.mapLastUpdate;\r\n        let squareInRange: Array<Square> = this.getSquareInRange(entity.targetSquare.x, entity.targetSquare.y, entity.mouvementRange);\r\n\r\n        let pathes = this.getWalkableTiles(entity.targetSquare, squareInRange, entity.mouvementRange);\r\n        this.collecteAccessibleTiles(entity, pathes);\r\n    }\r\n\r\n    private collecteAccessibleTiles(entity: Entity, pathes: Map<string, any[]>) {\r\n        entity.pathMap = pathes;\r\n    }\r\n\r\n    public mapLastUpdate: number = new Date().getTime();\r\n\r\n    public moveEntityFollowingPath(entity: Entity, path: Array<any>, callback: () => void, error: (e) => void): void {\r\n\r\n        let self = this,\r\n            grid = this.grid,\r\n            sourceSquare = this.getSquareAtPoint(entity.position);\r\n        let shortestPath = this.getPathTo(sourceSquare, _.last(path), entity.mouvementRange, true);\r\n\r\n        if (shortestPath === null) {\r\n            error('Path was not found.');\r\n            return;\r\n        }\r\n        let currentPositionIndex = 0;\r\n        move();\r\n        function move() {\r\n            let currentPathPoint = shortestPath[currentPositionIndex],\r\n                currentPosition = self.getPointAtSquare(currentPathPoint.x, currentPathPoint.y);\r\n            let square = self.getSquareAtPoint(currentPosition);\r\n            entity.square = square;\r\n\r\n            //at last position\r\n            if (currentPositionIndex >= shortestPath.length - 1) {\r\n                entity.move(currentPosition, () => {\r\n                    let targetSquare = self.getSquareAtPoint(currentPosition);\r\n                    entity.finishMoving();\r\n                    sourceSquare.entity = null;\r\n\r\n                    // un probleme ici ? cliquer sur 9:9 les zombies vont s'entasser\r\n                    targetSquare.entity = entity;\r\n\r\n                    let sourceInfo = grid[sourceSquare.y][sourceSquare.x];\r\n\r\n                    if (sourceInfo === 0 || sourceInfo === 1) {\r\n                        grid[sourceSquare.y][sourceSquare.x] = 0;\r\n                    } else if (sourceInfo > 9) {\r\n                        grid[sourceSquare.y][sourceSquare.x] -= 10;\r\n                    }\r\n\r\n                    grid[targetSquare.y][targetSquare.x] += 10;\r\n                    callback();\r\n                });\r\n                self.engine.moveGlowPosition(currentPosition);\r\n\r\n                self.mapLastUpdate = new Date().getTime();\r\n\r\n            } else {\r\n                currentPositionIndex = currentPositionIndex + 1;\r\n                console.log(\"moving to \", currentPosition.x + ':' + currentPosition.y, currentPathPoint);\r\n                entity.move(currentPosition, () => move());\r\n\r\n\r\n                self.engine.moveGlowPosition(currentPosition);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    public canEntityGoToTarget(entity: Entity, targetPoint: Phaser.Point) {\r\n        let targetSquare = this.getSquareAtPoint(targetPoint),\r\n            key = this.getCoordinatesKey(targetSquare.x, targetSquare.y);\r\n        return entity.pathMap.get(key) != null;\r\n    }\r\n\r\n    public moveEntityAtPoint(entity: Entity, targetPoint: Phaser.Point, callback: () => void, error: (e) => void): void {\r\n        let sourceSquare = this.getSquareAtPoint(entity.position),\r\n            targetSquare = this.getSquareAtPoint(targetPoint),\r\n            grid = this.grid;\r\n\r\n\r\n        // on recalcule le chemin en activant les diagonales pour un chemin plus fluide\r\n        let shortestPath = this.getPathTo(sourceSquare, targetSquare, entity.mouvementRange, true);\r\n\r\n        if (!shortestPath) {\r\n            error('Path was not found.');\r\n            return;\r\n        }\r\n        let currentPositionIndex = 0;\r\n\r\n\r\n        let move = () => {\r\n            let currentPathPoint = shortestPath[currentPositionIndex],\r\n                currentPosition = this.getPointAtSquare(currentPathPoint.x, currentPathPoint.y),\r\n                square = this.getSquareAtPoint(currentPosition);\r\n            entity.square = square;\r\n            if (currentPositionIndex >= shortestPath.length - 1) {\r\n                entity.move(currentPosition, () => {\r\n                    entity.finishMoving();\r\n                    sourceSquare.entity = null;\r\n                    targetSquare.entity = entity;\r\n\r\n                    let sourceInfo = grid[sourceSquare.y][sourceSquare.x];\r\n\r\n                    if (sourceInfo === 0 || sourceInfo === 1) {\r\n                        grid[sourceSquare.y][sourceSquare.x] = 0;\r\n                    } else if (sourceInfo > 9) {\r\n                        grid[sourceSquare.y][sourceSquare.x] -= 10;\r\n                    }\r\n\r\n                    grid[targetSquare.y][targetSquare.x] += 10;\r\n                    callback();\r\n                });\r\n                this.engine.moveGlowPosition(currentPosition);\r\n            } else {\r\n                currentPositionIndex = currentPositionIndex + 1;\r\n                console.log(\"moving to \", currentPosition.x + ':' + currentPosition.y, currentPathPoint);\r\n                entity.move(currentPosition, () => move());\r\n\r\n\r\n                this.engine.moveGlowPosition(currentPosition);\r\n            }\r\n        }\r\n        move();\r\n    }\r\n\r\n    public setDead(dead: Entity) {\r\n        dead.square.entity = null;\r\n        let grid = this.grid,\r\n            sourceSquare = dead.square,\r\n            sourceInfo = grid[sourceSquare.y][sourceSquare.x];\r\n\r\n        if (sourceInfo <= 1) {\r\n            grid[sourceSquare.y][sourceSquare.x] = 0;\r\n        } else if (sourceInfo > 9) {\r\n            grid[sourceSquare.y][sourceSquare.x] -= 10;\r\n        }\r\n    }\r\n\r\n    public getName(): string {\r\n        return this.name;\r\n    }\r\n    public getSize(): MapSize {\r\n        return this.size;\r\n    }\r\n    public getPointAtSquare(squareX: number, squareY: number): Phaser.Point {\r\n        let point: Phaser.Point = new Phaser.Point();\r\n        point.x = Math.min(squareX * 32, this.size.width * 32);\r\n        point.y = Math.min(squareY * 32, this.size.width * 32);\r\n        return point;\r\n    }\r\n    public getSquare(x: number, y: number): Square {\r\n        let key = this.getCoordinatesKey(x, y);\r\n        return this.squares.get(key);\r\n\r\n    }\r\n    public getSquareAtPoint(point: Phaser.Point): Square {\r\n\r\n        let key = this.getPointKey(point),\r\n            squareX = Math.min(point.x / 32, this.size.width),\r\n            squareY = Math.min(point.y / 32, this.size.width);\r\n\r\n        if (!this.squares.has(key)) {\r\n            this.squares.set(key, {\r\n                entity: null,\r\n                x: squareX,\r\n                y: squareY,\r\n                cover: 0,\r\n                data: {},\r\n                mask: false\r\n            })\r\n        }\r\n\r\n        return this.squares.get(key);\r\n    }\r\n\r\n    private getPointKey(point: Phaser.Point): string {\r\n        let squareX = Math.min(point.x / 32, this.size.width),\r\n            squareY = Math.min(point.y / 32, this.size.width);\r\n        return this.getCoordinatesKey(squareX, squareY);\r\n    }\r\n    private getCoordinatesKey(x: number, y: number): string {\r\n        return x + ':' + y;\r\n    }\r\n\r\n    public getPathTo(start: Square, end: Square, range: number, useDiagonal?: boolean): Array<any> {\r\n        let graph = this.buildNewGraph(end, useDiagonal),\r\n            startTile = graph.grid[start.x][start.y],\r\n            endTile = graph.grid[end.x][end.y],\r\n            pathes = new Map<string, Array<any>>(),\r\n            rawPath: Array<GridNode> = astar.search(graph, startTile, endTile),\r\n            length = rawPath.length;\r\n\r\n        //on coupe le chemin pour n'avoir que la partie la plus courte\r\n        let path = _.dropRight(rawPath.map(p => { return { x: p.x, y: p.y } }), length - 1 - range);\r\n\r\n        return path;\r\n    }\r\n\r\n    private getWalkableTiles(start: Square, squareInRange: Array<Square>, range: number): Map<string, Array<any>> {\r\n\r\n        ///  a faire, voir les cases qui sont directements accessibles, tracer les chemins pour les autres cas\r\n\r\n        console.time('getWalkableTiles');\r\n\r\n        let self = this,\r\n            tilesCalculated = 0,\r\n            tilesCalculatedFinish = 0,\r\n            currentDistance: number = 999,\r\n            currentGroupIndex = -1,\r\n            grid = this.grid,\r\n            filteredPathes = new Map<string, Array<any>>(),\r\n            pathes = new Map<string, Array<any>>(),\r\n            graph = this.buildNewGraph(),\r\n            squaresGroupedByDistance: Array<Array<Square>>,\r\n            processedGroupIndex;\r\n\r\n        //for max range\r\n        // search surrounding nodes\r\n\r\n        squaresGroupedByDistance = squareInRange\r\n            .sort((s1, s2) => s1.data.distanceFrom - s2.data.distanceFrom)\r\n            .reverse()\r\n            .reduce((groupedByDistance, currentSquare) => {\r\n                if (currentSquare.data.distanceFrom != currentDistance) {\r\n                    currentDistance = currentSquare.data.distanceFrom;\r\n                    currentGroupIndex++;\r\n                    groupedByDistance.push([]);\r\n                }\r\n                currentSquare.data.process = true;\r\n                groupedByDistance[currentGroupIndex].push(currentSquare);\r\n                return groupedByDistance;\r\n            }\r\n            , new Array<Array<Square>>());\r\n        processedGroupIndex = 0;\r\n\r\n\r\n        let startTile = graph.grid[start.x][start.y];\r\n\r\n        console.time('astar.search');\r\n        squaresGroupedByDistance.forEach(squares => {\r\n            squares.forEach(currentSquare => {\r\n                let endTile = graph.grid[currentSquare.x][currentSquare.y],\r\n                    pathKey = this.getCoordinatesKey(currentSquare.x, currentSquare.y);\r\n\r\n                if (pathes.has(pathKey)) {\r\n                    return;\r\n                }\r\n\r\n                let rawPath: Array<GridNode> = astar.search(graph, startTile, endTile);\r\n\r\n                //on déroule le chemin, et on remplis les chemin vers les cases\r\n                if (_.isEmpty(rawPath) || rawPath.length > range) {\r\n                    pathes.set(pathKey, null);\r\n                    return;\r\n                }\r\n                let path = rawPath.map(p => { return { x: p.x, y: p.y } });\r\n                let length = path.length;\r\n                path.forEach((square, index) => {\r\n                    let pathToSquare = _.dropRight(path, length - 1 - index);\r\n                    pathes.set(this.getCoordinatesKey(square.x, square.y), pathToSquare);\r\n                }\r\n                );\r\n            });\r\n        });\r\n        console.timeEnd('astar.search');\r\n        pathes.forEach((pathTo, key) => {\r\n            if (pathTo) {\r\n                filteredPathes.set(key, pathTo);\r\n            }\r\n        }\r\n        );\r\n\r\n        console.timeEnd(\"getWalkableTiles\");\r\n        return filteredPathes;\r\n    }\r\n\r\n\r\n    private buildNewGraph(square?: Square, useDiagonal?: boolean): any {\r\n\r\n        let negativeCollisionGrid = _.range(50).map(x => _.range(50).map(y => -1));\r\n\r\n        this.grid.map(\r\n            (line, rowIndex) => {\r\n                line.forEach(\r\n                    (tile, columnIndex) =>\r\n                        negativeCollisionGrid[columnIndex][rowIndex] = tile > 0 ? 0 : 1\r\n                );\r\n            }\r\n        )\r\n\r\n        if (square) {\r\n            negativeCollisionGrid[square.x][square.y] = 1;\r\n        }\r\n\r\n        //return new Graph(negativeCollisionGrid);\r\n        return new Graph(negativeCollisionGrid, { diagonal: useDiagonal });\r\n    }\r\n\r\n}\r\n\r\ninterface MapSize {\r\n    width: number,\r\n    height: number\r\n}\r\n\r\nexport interface Square {\r\n    x: number,\r\n    y: number,\r\n    entity: Entity,\r\n    cover: number,\r\n    data: any,\r\n    mask: boolean\r\n}\r\ninterface GridNode {\r\n    x: number\r\n    y: number\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/map.ts","import { _Entity } from 'app/game/_entity'\r\nimport { Entity } from 'app/game/entity'\r\nimport { Weapon, WeaponPool, WEAPONS } from 'app/game/weapon'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { Game } from 'app/game/game'\r\n\r\nexport class Player extends _Entity {\r\n    constructor(engine: Engine, position: Phaser.Point, teamId: number, team: Array<Player>, public game: Game) {\r\n        super(engine, position);\r\n        this.sprite = engine.createHuman(position);\r\n        this.teamId = teamId;\r\n        this.maxAction = 2;\r\n        this.mouvementRange = 10;\r\n        this.visionRange = 4;\r\n        this.coverDetection = 10;\r\n        this.updateAccessibleTiles = true;\r\n        team.push(this);\r\n    }\r\n\r\n    public move(targetPosition: Phaser.Point, callback: () => void): Player {\r\n        super.move(targetPosition, callback);\r\n        return this;\r\n    }\r\n\r\n    static popPlayer(engine: Engine, position: Phaser.Point, teamId: number, team: Array<Player>, game: Game): Player {\r\n        let newPlayer = new Player(engine, position, teamId, team, game);\r\n        newPlayer.addWeapon(WEAPONS.NINEMM);\r\n        return newPlayer;\r\n    }\r\n    public attack(target: Entity): Player {\r\n        super.attack(target);\r\n        this.engine.playSound('gun');\r\n        this.engine.shake();\r\n\r\n        this.weapons[this.selectedWeaponIndex].fire(this, target);\r\n        console.log('zombie attacks ' + target.id + target.teamId);\r\n        return this;\r\n    }\r\n\r\n    public addWeapon(weaponType: WEAPONS): Player {\r\n        this.weapons.push(WeaponPool.add(weaponType, this.game));\r\n\r\n        return this\r\n    }\r\n    public selectWeapon(index:number):Player{\r\n        this.selectedWeaponIndex = index;\r\n        return this\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/player.ts","import { Spawnable } from 'app/phaser/spawnable'\r\n\r\nexport class VisibilitySprite extends Spawnable {\r\n\r\n    constructor(game: Phaser.Game) {\r\n        super(game, null, null, 'markers');\r\n        this.animations.add(\"visible\", [\"marker/visible_tile\"], 5, true);\r\n        this.play(\"visible\");\r\n    }\r\n\r\n    spawn(x: number, y: number, data: any){\r\n        super.spawn(x, y, data);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/visibilitySprite.ts","import { _Entity } from 'app/game/_entity'\r\nimport { Entity } from 'app/game/entity'\r\nimport { Weapon } from 'app/game/weapon'\r\nimport { Engine } from 'app/phaser/engine'\r\nimport { GameMap } from 'app/game/map'\r\nimport { Game } from 'app/game/game'\r\nimport { Square } from 'app/game/map'\r\nimport * as _ from 'lodash'\r\n\r\nenum status {\r\n    ALERT,\r\n    IDDLE,\r\n    SEARCHING\r\n}\r\nconst zombieTypes = ['01', '02', '03', '04', '05', '06', '07', '08']\r\n\r\nexport class Zombie extends _Entity {\r\n\r\n    currentStatus: status;\r\n\r\n    constructor(engine: Engine, position: Phaser.Point, teamId: number, team: Array<Zombie>, public game: Game) {\r\n        super(engine, position);\r\n        this.sprite = engine.createZombie(position, zombieTypes[_.random(0, zombieTypes.length - 1)]);\r\n        this.teamId = teamId;\r\n        this.team = team;\r\n        this.maxAction = 2;\r\n        this.mouvementRange = 6;\r\n        this.pv = 6;\r\n        this.currentStatus = status.IDDLE;\r\n        this.visionRange = 12;\r\n        this.coverDetection = 10;\r\n        this.updateAccessibleTiles = true;\r\n        team.push(this);\r\n    }\r\n\r\n    static popZombie(engine: Engine, position: Phaser.Point, teamId: number, team: Array<Zombie>, game: Game): Zombie {\r\n        let newZombie = new Zombie(engine, position, teamId, team, game);\r\n        return newZombie;\r\n    }\r\n\r\n\r\n    public play(callback: () => void): void {\r\n\r\n        let visibleEntities: Array<Entity> = this.visibleSquares.filter(square => square.entity).map(s => s.entity);\r\n\r\n        if (this.lookForHumaaaans(visibleEntities, callback)) {\r\n            console.log('fresh meat ...')\r\n        } else {\r\n            this.goForCloserZombie(visibleEntities, callback);\r\n        }\r\n    }\r\n\r\n    private pathToClosestEntity(entitiesGroup: Array<Entity>): closestEntityReturn {\r\n        let closerHuman = null,\r\n            actualDistanceFromHuman = 999,\r\n            mouvementRange = this.mouvementRange,\r\n            pathToGo: Array<any> = null,\r\n            actualSquare = this.square,\r\n            pathes = this.pathMap,\r\n            moveTargetSquare: Square,\r\n            self = this,\r\n            game = this.game;\r\n        entitiesGroup.forEach(h => {\r\n            let targetSquare = h.square;\r\n\r\n            //check les 8 cases adjacentes à la cible\r\n            checkPath(targetSquare.x - 1, targetSquare.y - 1);\r\n            checkPath(targetSquare.x, targetSquare.y - 1);\r\n            checkPath(targetSquare.x + 1, targetSquare.y - 1);\r\n            checkPath(targetSquare.x - 1, targetSquare.y);\r\n            checkPath(targetSquare.x + 1, targetSquare.y);\r\n            checkPath(targetSquare.x - 1, targetSquare.y + 1);\r\n            checkPath(targetSquare.x, targetSquare.y + 1);\r\n            checkPath(targetSquare.x + 1, targetSquare.y + 1);\r\n            if (!pathToGo) {\r\n                let path = this.game.getPathTo(actualSquare, targetSquare, mouvementRange),\r\n                    lastStep = _.last(path),\r\n                    lastSquare = lastStep ? this.game.getSquare(lastStep.x, lastStep.y) : null;\r\n                console.log('path to humaaaans', pathToGo);\r\n                if (path) {\r\n                    setClosestPath(path, lastSquare);\r\n                    return\r\n                }\r\n            }\r\n\r\n            function checkPath(x: number, y: number) {\r\n                if (actualSquare.x === x && actualSquare.y === y) {\r\n                    setClosestPath([], actualSquare);\r\n                    return;\r\n                }\r\n\r\n                let square: Square = game.getSquare(x, y);\r\n                if (square.entity) {\r\n                    return\r\n                }\r\n                let path = game.getPathTo(actualSquare, square, mouvementRange),\r\n                    lastStep = _.last(path),\r\n                    lastSquare = lastStep ? game.getSquare(lastStep.x, lastStep.y) : null;\r\n\r\n                if (path && path.length > 0 && path.length < actualDistanceFromHuman && lastSquare === square) {\r\n                    setClosestPath(path, lastSquare);\r\n                    return\r\n                }\r\n            }\r\n            function pathStepEqualsToSquare(pathStep: any, square: Square) {\r\n                return pathStep.x === square.x && pathStep.y === square.y;\r\n            }\r\n\r\n            function setClosestPath(path: Array<any>, square: Square) {\r\n                closerHuman = h;\r\n                actualDistanceFromHuman = path.length;\r\n                pathToGo = path;\r\n                moveTargetSquare = square;\r\n            }\r\n        })\r\n\r\n        return {\r\n            distance: actualDistanceFromHuman,\r\n            entity: closerHuman,\r\n            path: pathToGo,\r\n            target: moveTargetSquare\r\n        }\r\n    }\r\n\r\n\r\n    private goForCloserZombie(entities: Array<Entity>, callback: () => void): boolean {\r\n        let zombie = entities.filter(e => e.teamId === this.teamId && e.id != this.id);\r\n        let pathToClosest = this.pathToClosestEntity(zombie);\r\n\r\n        if (!pathToClosest.entity) {\r\n            callback();\r\n            return false;\r\n        }\r\n\r\n        if (pathToClosest.distance === 0) {\r\n            //this.attack(closerHuman);\r\n            //attack\r\n            this.updateAccessibleTiles = false;\r\n            callback();\r\n        } else {\r\n            this.targetSquare = pathToClosest.target;\r\n            this.updateAccessibleTiles = true;\r\n\r\n            this.game.map.moveEntityFollowingPath(this, pathToClosest.path, () => callback(), () => console.error('oh ...'));\r\n        }\r\n\r\n        return false;\r\n    }\r\n    private lookForHumaaaans(entities: Array<Entity>, callback: () => void): boolean {\r\n\r\n        let humans = entities.filter(e => e.teamId !== this.teamId);\r\n\r\n        let pathToClosest = this.pathToClosestEntity(humans);\r\n        //plus tard, il ira de manière aléatoire en favorisant le plus proche\r\n\r\n\r\n        if (!pathToClosest.entity) {\r\n            return false;\r\n        }\r\n\r\n        if (pathToClosest.distance === 0) {\r\n            this.attack(pathToClosest.entity);\r\n            //attack\r\n            this.updateAccessibleTiles = false;\r\n            callback();\r\n        } else {\r\n            this.targetSquare = pathToClosest.target;\r\n            this.updateAccessibleTiles = true;\r\n\r\n            this.game.map.moveEntityFollowingPath(this, pathToClosest.path, () => callback(), () => console.error('oh ...'));\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    public attack(target: Entity): Zombie {\r\n        super.attack(target);\r\n        this.engine.playSound('grunt');\r\n        this.engine.shake();\r\n        console.log('zombie attacks ' + target.id + target.teamId);\r\n        return this;\r\n    }\r\n\r\n    public touched(sourceEntity: Entity, damage: number): Zombie {\r\n        console.log('aaaargh', sourceEntity, 'hit me for', damage);\r\n        this.engine.playSound('grunt');\r\n\r\n        this.pv = this.pv - damage;\r\n\r\n        if (this.pv <= 0) {\r\n            console.log('aaaargh, i am really dead');\r\n\r\n            this.die(sourceEntity);\r\n\r\n        }\r\n\r\n        return this;\r\n    }\r\n}\r\n\r\n\r\ninterface closestEntityReturn {\r\n    entity: Entity,\r\n    path: Array<any>,\r\n    distance: number,\r\n    target: Square\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/game/zombie.ts","import { Injectable } from '@angular/core'; \r\nimport { BaseRequestOptions, RequestOptions } from '@angular/http'; \r\n \r\n@Injectable() \r\nexport class DefaultRequestOptions extends BaseRequestOptions { \r\n \r\n  constructor() { \r\n    super(); \r\n \r\n    // Set the default 'Content-Type' header \r\n    this.headers.set('Content-Type', 'application/json'); \r\n  } \r\n} \r\n \r\nexport const requestOptionsProvider = { provide: RequestOptions, useClass: DefaultRequestOptions }; \r\n \r\n \r\n/* \r\nCopyright 2017 Google Inc. All Rights Reserved. \r\nUse of this source code is governed by an MIT-style license that \r\ncan be found in the LICENSE file at http://angular.io/license \r\n*/\n\n\n// WEBPACK FOOTER //\n// ./src/app/loader/default-request-options.service.ts","import { Injectable } from '@angular/core';\r\nimport { Http, Response } from '@angular/http';\r\nimport 'rxjs/add/operator/map';\r\nimport { Observable } from 'rxjs/Observable';\r\n\r\n@Injectable()\r\nexport class GameService {\r\n\r\n    constructor(private http: Http) { }\r\n\r\n\r\n    getMapJson(mapKey: string): Observable<MapResponse> {\r\n        //assets/tiles/map00.json\r\n        return this.http.get('assets/tiles/' + mapKey + '.json').map(response => this.buildMapResponse(mapKey, response));\r\n    }\r\n\r\n    private buildMapResponse(mapKey: string, response: Response): MapResponse {\r\n        let json = response.json(),\r\n            tilesets: Array<any> = json.tilesets,\r\n            layers: Array<any> = json.layers;\r\n\r\n        return {\r\n            name: mapKey,\r\n            data: response.json(),\r\n            layers: layers,\r\n            tilesetImages: tilesets.map(s => <Tileset>{\r\n                url: 'assets/tiles/' + s.image,\r\n                key: s.name\r\n            })\r\n        };\r\n    }\r\n\r\n    public LoadTileMap(mapResponse: MapResponse, game: Phaser.Game): void {\r\n        game.load.tilemap(mapResponse.name, null, mapResponse.data, Phaser.Tilemap.TILED_JSON);\r\n\r\n        mapResponse.tilesetImages.forEach(t => {\r\n            game.load.image(t.key, t.url);\r\n        });\r\n    }\r\n\r\n    public create(mapResponse: MapResponse, game: Phaser.Game, group: Phaser.Group): CreatedMap {\r\n        let map: Phaser.Tilemap = game.add.tilemap(mapResponse.name, 16, 16);\r\n        mapResponse.tilesetImages.forEach(t => {\r\n            game.load.image(t.key, t.url);\r\n            map.addTilesetImage(t.key, t.key);\r\n        });\r\n\r\n        let layers = new Map<string, Phaser.TilemapLayer>();\r\n        let tilePropertyMap = new Map<number, any>();\r\n        mapResponse.layers.forEach(l => {\r\n            let layer: Phaser.TilemapLayer = map.createLayer(l.name);\r\n            layer.visible = l.opacity === 1;\r\n            layers.set(l.name, layer);\r\n            group.add(layer);\r\n        })\r\n\r\n        let tilesets: Array<any> = mapResponse.data.tilesets;\r\n        tilesets.map(t => {\r\n            return {\r\n                'firstgid': t.firstgid,\r\n                'tiles': t.tiles\r\n            }\r\n        })\r\n            .filter(t => t.tiles)\r\n            .map(t => {\r\n\r\n                let index = 0,\r\n                    tiles = t.tiles;\r\n\r\n\r\n                for (var item in tiles) {\r\n                    let objectgroup = tiles[item].objectgroup;\r\n                    if(objectgroup){\r\n                        tilePropertyMap.set(t.firstgid+index, objectgroup);\r\n                        index++;\r\n                    }\r\n                }\r\n            }\r\n            );\r\n\r\n        return {\r\n            map: map,\r\n            layers: layers,\r\n            tileMap: tilePropertyMap\r\n        };\r\n    }\r\n}\r\n\r\nexport interface CreatedMap {\r\n    map: Phaser.Tilemap,\r\n    layers: Map<string, Phaser.TilemapLayer>,\r\n    tileMap: Map<number, any>\r\n}\r\n\r\nexport interface MapResponse {\r\n    name: string,\r\n    data: any,\r\n    layers: Array<Layer>\r\n    tilesetImages: Array<Tileset>\r\n}\r\ninterface Layer {\r\n    name, string,\r\n    opacity: number\r\n}\r\ninterface Tileset {\r\n    url: string,\r\n    key: string\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/loader/game.service.ts","export default class DelayedAnimation extends Phaser.Animation {\r\n    _parent: any;\r\n    _frameData: any;\r\n    _frames: any;\r\n    _frameIndex: number;\r\n    isReversed: any;\r\n    _timeLastFrame: number;\r\n    _frameDiff: number;\r\n    _frameSkip: number;\r\n    _timeNextFrame: any;\r\n\r\n    private timelineDelay:number\r\n\r\n    static addToAnimations(animationManager: any, delay, name, frames, frameRate, loop, useNumericIndex?) {\r\n\r\n        frames = frames || [];\r\n        frameRate = frameRate || 60;\r\n\r\n        if (loop === undefined) { loop = false; }\r\n\r\n        //  If they didn't set the useNumericIndex then let's at least try and guess it\r\n        if (useNumericIndex === undefined)\r\n        {\r\n            if (frames && typeof frames[0] === 'number')\r\n            {\r\n                useNumericIndex = true;\r\n            }\r\n            else\r\n            {\r\n                useNumericIndex = false;\r\n            }\r\n        }\r\n\r\n        animationManager._outputFrames = [];\r\n\r\n        animationManager._frameData.getFrameIndexes(frames, useNumericIndex, animationManager._outputFrames);\r\n\r\n        let delayedAnimation = new DelayedAnimation(animationManager.game, animationManager.sprite, name, animationManager._frameData, animationManager._outputFrames, frameRate, loop);\r\n\r\n        delayedAnimation.timelineDelay = delay;\r\n\r\n        animationManager._anims[name] = delayedAnimation;\r\n\r\n\r\n\r\n        animationManager.currentAnim = animationManager._anims[name];\r\n\r\n        if (animationManager.sprite.tilingTexture)\r\n        {\r\n            animationManager.sprite.refreshTexture = true;\r\n        }\r\n\r\n        return animationManager._anims[name];\r\n\r\n    }\r\n\r\n\r\n    update(): boolean {\r\n\r\n\r\n\r\n\r\n\r\n        if (this.isPaused)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        if (this.isPlaying && this.game.time.time >= this._timeNextFrame)\r\n        {\r\n            this._frameSkip = 1;\r\n\r\n            //  Lagging?\r\n            this._frameDiff = this.game.time.time - this._timeNextFrame + this.timelineDelay;\r\n\r\n            this._timeLastFrame = this.game.time.time;\r\n\r\n            if (this._frameDiff > this.delay)\r\n            {\r\n                //  We need to skip a frame, work out how many\r\n                this._frameSkip = Math.floor(this._frameDiff / this.delay);\r\n                this._frameDiff -= (this._frameSkip * this.delay);\r\n            }\r\n\r\n            //  And what's left now?\r\n            this._timeNextFrame = this.game.time.time + (this.delay - this._frameDiff);\r\n\r\n            if (this.isReversed)\r\n            {\r\n                this._frameIndex -= this._frameSkip;\r\n            }\r\n            else\r\n            {\r\n                this._frameIndex += this._frameSkip;\r\n            }\r\n\r\n            if (!this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1)\r\n            {\r\n                if (this.loop)\r\n                {\r\n                    // Update current state before event callback\r\n                    this._frameIndex = Math.abs(this._frameIndex) % this._frames.length;\r\n\r\n                    if (this.isReversed)\r\n                    {\r\n                        this._frameIndex = this._frames.length - 1 - this._frameIndex;\r\n                    }\r\n\r\n                    this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]);\r\n\r\n                    //  Instead of calling updateCurrentFrame we do it here instead\r\n                    if (this.currentFrame)\r\n                    {\r\n                        this._parent.setFrame(this.currentFrame);\r\n                    }\r\n\r\n                    this.loopCount++;\r\n                    this._parent.events.onAnimationLoop$dispatch(this._parent, this);\r\n                    this.onLoop.dispatch(this._parent, this);\r\n\r\n                    if (this.onUpdate)\r\n                    {\r\n                        this.onUpdate.dispatch(this, this.currentFrame);\r\n\r\n                        // False if the animation was destroyed from within a callback\r\n                        return !!this._frameData;\r\n                    }\r\n                    else\r\n                    {\r\n                        return true;\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    this.complete();\r\n                    return false;\r\n                }\r\n            }\r\n            else\r\n            {\r\n                return this.updateCurrentFrame(true);\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/phaser/delayedAnimation.ts","import { Entity } from 'app/game/entity'\r\nimport { GameService, MapResponse, CreatedMap } from 'app/loader/game.service';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { Pool } from 'app/phaser/pool'\r\nimport { VisibilitySprite } from 'app/game/visibilitySprite'\r\nimport DelayedAnimation from 'app/phaser/delayedAnimation'\r\n\r\n//http://rpgmaker.su-downloads/%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F/238-pop-horror-city-character-pack-1-a\r\n//https://forums.rpg-akerweb.com/index.php?threads/pop-freebies.45329/\r\n// https://www.leshylabs.com/apps/sstool/\r\n\r\n\r\n/*\r\n<div class=\"frame ctooltip\">\r\n  \r\n    <div style=\"background: #225378\"></div>\r\n  \r\n    <div style=\"background: #1695A3\"></div>\r\n  \r\n    <div style=\"background: #ACF0F2\"></div>\r\n  \r\n    <div style=\"background: #F3FFE2\"></div>\r\n  \r\n    <div style=\"background: #EB7F00\"></div>\r\n  \r\n  \r\n</div>\r\n<div class=\"frame ctooltip\">\r\n  \r\n    <div style=\"background: #DC3522\"></div>\r\n  \r\n    <div style=\"background: #D9CB9E\"></div>\r\n  \r\n    <div style=\"background: #374140\"></div>\r\n  \r\n    <div style=\"background: #2A2C2B\"></div>\r\n  \r\n    <div style=\"background: #1E1E20\"></div>\r\n  </div>\r\n */\r\nexport class Engine {\r\n    visibleMarkerPool: Pool;\r\n    rangegroup: Phaser.Group;\r\n    visiongroup: Phaser.Group;\r\n    gamegroup: Phaser.Group;\r\n    private soundeffect: Phaser.Sound;\r\n    private glowTween: Phaser.Tween;\r\n    private glowPosition: Phaser.Point;\r\n    private tileMap: Map<number, any>;\r\n    private text: Phaser.Text;\r\n    private xptext: Phaser.Text;\r\n    private marker: Phaser.Sprite;\r\n    private glow: Phaser.Sprite;\r\n    private collisionLayer: Phaser.TilemapLayer;\r\n    private horizontalScroll = true;\r\n    private verticalScroll = true;\r\n    private kineticMovement = true;\r\n    private scroller;\r\n    public phaserGame: Phaser.Game;\r\n    private cursors: Phaser.CursorKeys;\r\n    //private player: Phaser.Sprite;\r\n    private wasd: any;\r\n    private speed = 300;\r\n    public map: Phaser.Tilemap;\r\n    private tween: Phaser.Tween;\r\n    private startX: number;\r\n    private startY: number;\r\n    public observable: Observable<string>;\r\n    private status: (string) => void;\r\n    private o;\r\n    private click: (point: Phaser.Point) => void;\r\n    private over: (point: Phaser.Point) => void;\r\n    private overOff: (point: Phaser.Point) => void;\r\n    debug: boolean = true;\r\n\r\n\r\n    constructor(mapName: string, private gameService: GameService) {\r\n        this.observable = Observable.create(o => {\r\n            this.o = o;\r\n            this.status = o.next;\r\n        });\r\n        this.gameService.getMapJson(mapName).subscribe(\r\n            next => this.init(next),\r\n            error => console.error('error loading map'),\r\n            () => console.log('c\\'est fini'));\r\n    }\r\n    private init(mapResponse: MapResponse) {\r\n        let self = this;\r\n\r\n        this.phaserGame = new Phaser.Game((window.innerWidth / 2) * window.devicePixelRatio, (window.innerHeight / 2) * window.devicePixelRatio, Phaser.WEBGL, 'game', { preload: preload, create: create, update: update }, false, false);\r\n\r\n        function preload() {\r\n            self.preload(mapResponse);\r\n        }\r\n        function create() {\r\n            self.create(mapResponse);\r\n        }\r\n        function update() {\r\n            self.update();\r\n        }\r\n    }\r\n\r\n    public bindClick(click: (point: Phaser.Point) => void) {\r\n        this.click = click;\r\n    }\r\n    public bindOver(over: (point: Phaser.Point) => void, overOff: (point: Phaser.Point) => void) {\r\n        this.over = over;\r\n        this.overOff = overOff;\r\n    }\r\n    public shake() {\r\n        this.phaserGame.camera.resetFX();\r\n        this.phaserGame.camera.shake(0.004, 100, true, Phaser.Camera.SHAKE_BOTH, true);\r\n        //this.phaserGame.camera.flash(0xffffff, 50, false, 0.7);\r\n    }\r\n\r\n    private preload(mapResponse: MapResponse) {\r\n\r\n        Phaser.Canvas.setImageRenderingCrisp(this.phaserGame.canvas);\r\n        //this.phaserGame.scale.scaleMode = Phaser.ScaleManager.USER_SCALE;\r\n        //this.phaserGame.scale.setUserScale(2, 2);\r\n        this.phaserGame.load.atlas('sprites', 'assets/sprites/spriteatlas/sprites.png', 'assets/sprites/spriteatlas/sprites.json', Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);\r\n        this.phaserGame.load.atlas('heroes-sprites', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Male_Heroes.png', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Male_Heroes.json', Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);\r\n        this.phaserGame.load.atlas('Male-Zombies-Gore', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Male_Zombies_Gore.png', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Male_Zombies_Gore.json', Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);\r\n        this.phaserGame.load.atlas('markers', 'assets/tiles/POPHorrorCity_GFX/Graphics/System/markers.png', 'assets/tiles/POPHorrorCity_GFX/Graphics/System/markers.json', Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);\r\n        this.gameService.LoadTileMap(mapResponse, this.phaserGame);\r\n        this.phaserGame.load.audio('boden', ['assets/sounds/essai.mp3']);\r\n        this.phaserGame.load.audio('MechDrone1', ['assets/sounds/MechDrone1.mp3']);\r\n        this.phaserGame.load.audio('soundeffect', ['assets/sounds/soundeffect_game.ogg']);\r\n        this.phaserGame.load.atlas('candle-glow', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Objects/Candle_Glow.png', 'assets/tiles/POPHorrorCity_GFX/Graphics/Characters/Objects/Candle_Glow.json', Phaser.Loader.TEXTURE_ATLAS_JSON_ARRAY);\r\n\r\n        this.phaserGame.load.image('bullet8', 'assets/sprites/bullet8.png');\r\n        this.phaserGame.load.image('bullet6', 'assets/sprites/bullet6.png');\r\n    }\r\n\r\n    create(mapResponse: MapResponse) {\r\n        let game: Phaser.Game = this.phaserGame;\r\n        let MechDrone1 = game.add.audio('MechDrone1', 1, true);\r\n        let soundeffect = game.add.audio('soundeffect', 0.1, true);\r\n        this.gamegroup = game.add.group();\r\n        this.rangegroup = game.add.group();\r\n        this.visiongroup = game.add.group();\r\n        let gamegroup = this.gamegroup;\r\n\r\n        MechDrone1.play();\r\n        MechDrone1.volume = 0.5;\r\n        soundeffect.volume = 0;\r\n\r\n        //à enlever\r\n        game.camera.setPosition(32, 32);\r\n\r\n        soundeffect.allowMultiple = true;\r\n        soundeffect.addMarker('shotgun', 1.130, 0.985);\r\n        soundeffect.addMarker('gun', 0.575, 0.550);\r\n        soundeffect.addMarker('grunt', 0, 0.570);\r\n        this.soundeffect = soundeffect;\r\n\r\n        game.physics.startSystem(Phaser.Physics.ARCADE);\r\n\r\n        let createdMap: CreatedMap = this.gameService.create(mapResponse, game, this.gamegroup);\r\n        let collisionLayer = createdMap.layers.get('collisions');\r\n\r\n        this.map = createdMap.map;\r\n        this.tileMap = createdMap.tileMap;\r\n\r\n        this.collisionLayer = collisionLayer;\r\n        //this.map.setCollisionByExclusion([], true, this.collisionLayer);\r\n\r\n        this.collisionLayer.resizeWorld();\r\n\r\n        this.cursors = game.input.keyboard.createCursorKeys();\r\n        this.wasd = {\r\n            cameraDown: game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_2),\r\n            cameraUp: game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_8),\r\n            cameraLeft: game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_4),\r\n            cameraRight: game.input.keyboard.addKey(Phaser.Keyboard.NUMPAD_6),\r\n            topTown: game.input.keyboard.addKey(Phaser.Keyboard.END)\r\n        };\r\n\r\n        this.visibleMarkerPool = new Pool(game, VisibilitySprite, 200, 'visibleMarker');\r\n        this.marker = game.add.sprite(0, 0, 'markers');\r\n        gamegroup.add(this.marker);\r\n        this.marker.animations.add(\"blink\", [\"marker/blink1\", \"marker/blink2\"], 5, true);\r\n        this.marker.play(\"blink\");\r\n        game.physics.enable(this.marker, Phaser.Physics.ARCADE);\r\n\r\n\r\n        this.glow = game.add.sprite(-100, -100, 'markers');\r\n        gamegroup.add(this.glow);\r\n        this.glow.animations.add(\"glow\", [\"marker/active_entity\"], 5, true);\r\n        this.glow.play(\"glow\");\r\n        game.physics.enable(this.glow, Phaser.Physics.ARCADE);\r\n\r\n\r\n        let lastLayer = createdMap.layers.get('example sprite');\r\n        lastLayer.inputEnabled = true;\r\n        lastLayer.events.onInputDown.add(this.clickListener, this);\r\n\r\n        if (this.debug) {\r\n            this.text = this.phaserGame.add.text(-100, -100, '', null);\r\n        }\r\n\r\n        this.o.next('ok');\r\n        //this.gamegroup.scale.x = 2;\r\n        //this.gamegroup.scale.y = 2;\r\n    }\r\n    public removeAllAccessibleTiles() {\r\n        this.rangegroup.removeAll();\r\n    }\r\n\r\n    public addAccessibleTiles(tiles: Array<Phaser.Point>) {\r\n        this.removeAllAccessibleTiles();\r\n        tiles.forEach(tile => {\r\n            let tileSprite = this.phaserGame.add.sprite(tile.x, tile.y, 'markers');\r\n            this.rangegroup.add(tileSprite);\r\n            tileSprite.animations.add(\"glow\", [\"marker/accessible_tile\"], 5, true);\r\n            tileSprite.play(\"glow\");\r\n        }\r\n        );\r\n    }\r\n\r\n\r\n    mapVisibleTileCount: Map<string, number> = new Map();\r\n    mapVisibleTile: Map<string, Phaser.Sprite> = new Map();\r\n\r\n    public removeVisibleTiles(tilesKey: Array<string>) {\r\n        tilesKey.forEach(tileKey => {\r\n            if (this.mapVisibleTileCount.has(tileKey)) {\r\n                let count = 0;\r\n                this.mapVisibleTileCount.set(tileKey, count);\r\n                this.mapVisibleTile.get(tileKey).alive = false;\r\n                this.mapVisibleTile.get(tileKey).visible = false;\r\n            }\r\n        });\r\n    }\r\n    public removeAllVisibleTiles() {\r\n        this.mapVisibleTileCount = new Map();\r\n        this.mapVisibleTile = new Map();\r\n        this.visibleMarkerPool.sprites.forEach(sprite => {\r\n            sprite.alive = false;\r\n            sprite.visible = false;\r\n        });\r\n    }\r\n    public addVisibleTiles(oldTiles: Array<Phaser.Point>, tiles: Array<Phaser.Point>) {\r\n        //console.time('addVisibleTiles');\r\n\r\n        let oldKeysToDelete: Set<string> = new Set(),\r\n            newKeys: Set<string> = new Set();\r\n\r\n        tiles.forEach(tile => newKeys.add(tile.x + ':' + tile.y));\r\n        oldTiles.forEach(tile => {\r\n            if (!newKeys.has(tile.x + ':' + tile.y)) {\r\n                oldKeysToDelete.add(tile.x + ':' + tile.y)\r\n            }\r\n        });\r\n\r\n        this.removeVisibleTiles(Array.from(oldKeysToDelete));\r\n\r\n        tiles.forEach(tile => {\r\n            let tileKey = tile.x + ':' + tile.y;\r\n            if (!this.mapVisibleTileCount.has(tileKey)) {\r\n                this.mapVisibleTileCount.set(tileKey, 0);\r\n            }\r\n\r\n            let count = this.mapVisibleTileCount.get(tileKey);\r\n\r\n            if (count < 1) {\r\n                this.mapVisibleTile.set(tileKey, this.visibleMarkerPool.createNew(tile.x, tile.y));\r\n            }\r\n\r\n\r\n            if (!oldKeysToDelete.has(tileKey)) {\r\n                this.mapVisibleTileCount.set(tileKey, count + 1);\r\n            }\r\n        }\r\n        );\r\n        //console.timeEnd(\"addVisibleTiles\");\r\n    }\r\n\r\n\r\n    public createHuman(position: Phaser.Point): Phaser.Sprite {\r\n        let human = this.phaserGame.add.sprite(position.x, position.y - 32, 'heroes-sprites');\r\n        human.animations.add(\"down\", [\"sprite1\", \"sprite2\", \"sprite3\"], 5, true);\r\n        human.animations.add(\"left\", [\"sprite13\", \"sprite14\", \"sprite15\"], 5, true);\r\n        human.animations.add(\"right\", [\"sprite25\", \"sprite26\", \"sprite27\"], 5, true);\r\n        human.animations.add(\"up\", [\"sprite37\", \"sprite38\", \"sprite39\"], 5, true);\r\n        human.animations.add(\"stand-down\", [\"sprite2\"], 5, true);\r\n        human.play(\"stand-down\");\r\n        this.gamegroup.add(human);\r\n        return human;\r\n    }\r\n\r\n\r\n    public createZombie(position: Phaser.Point, zombieType: string): Phaser.Sprite {\r\n        let zombie = this.phaserGame.add.sprite(position.x, position.y - 32, 'Male-Zombies-Gore'),\r\n            framerate = 3;\r\n        zombie.smoothed = false;\r\n        zombie.scale.setTo(1, this.phaserGame.rnd.realInRange(0.9, 1.2))\r\n        let delay = this.phaserGame.rnd.integerInRange(0, 50);\r\n\r\n        //zombie.animations.add(\"down\", [zombieType + \"-down-1\", zombieType + \"-down-2\", zombieType + \"-down-3\", zombieType + \"-down-2\"], framerate, true);\r\n\r\n        DelayedAnimation.addToAnimations(zombie.animations, delay, \"down\", [zombieType + \"-down-1\", zombieType + \"-down-2\", zombieType + \"-down-3\", zombieType + \"-down-2\"], framerate, true);\r\n\r\n        zombie.animations.add(\"left\", [zombieType + \"-left-1\", zombieType + \"-left-2\", zombieType + \"-left-3\"], framerate, true);\r\n        zombie.animations.add(\"right\", [zombieType + \"-right-1\", zombieType + \"-right-2\", zombieType + \"-right-3\"], framerate, true);\r\n        zombie.animations.add(\"up\", [zombieType + \"-up-1\", zombieType + \"-up-2\", zombieType + \"-up-3\"], framerate, true);\r\n        zombie.animations.add(\"masked-down\", [\"00-down-1\", \"00-down-2\", \"00-down-3\"], framerate, true);\r\n        zombie.animations.add(\"masked-left\", [\"00-left-1\", \"00-left-2\", \"00-left-3\"], framerate, true);\r\n        zombie.animations.add(\"masked-right\", [\"00-right-1\", \"00-right-2\", \"00-right-3\"], framerate, true);\r\n        zombie.animations.add(\"masked-up\", [\"00-up-1\", \"00-up-2\", \"00-up-3\"], framerate, true);\r\n\r\n\r\n        zombie.play(\"down\");\r\n\r\n        let frameIndex = this.phaserGame.rnd.integerInRange(0, zombie.animations.currentAnim.frameTotal);\r\n\r\n\r\n\r\n        zombie.animations.currentAnim.setFrame(frameIndex);\r\n\r\n        this.gamegroup.add(zombie);\r\n        return zombie;\r\n    }\r\n\r\n    public playSound(soundName: string) {\r\n        this.soundeffect.volume = 0.5;\r\n\r\n        this.soundeffect.play(soundName);\r\n    }\r\n\r\n    private clickListener() {\r\n        let marker = this.marker,\r\n            targetPoint: Phaser.Point = new Phaser.Point();\r\n\r\n        targetPoint.x = marker.x;\r\n        targetPoint.y = marker.y;\r\n\r\n        this.click(targetPoint);\r\n    }\r\n\r\n    private overOffListener() {\r\n        let marker = this.marker,\r\n            targetPoint: Phaser.Point = new Phaser.Point();\r\n\r\n        targetPoint.x = marker.x;\r\n        targetPoint.y = marker.y;\r\n        this.overOff(targetPoint);\r\n    }\r\n    private overListener() {\r\n        let marker = this.marker,\r\n            targetPoint: Phaser.Point = new Phaser.Point();\r\n\r\n        targetPoint.x = marker.x;\r\n        targetPoint.y = marker.y;\r\n\r\n        this.over(targetPoint);\r\n    }\r\n\r\n    public setGlowPosition(position: Phaser.Point) {\r\n        this.phaserGame.tweens.removeAll();\r\n        this.glow.x = position.x;\r\n        this.glow.y = position.y;\r\n\r\n    }\r\n\r\n    public moveGlowPosition(position: Phaser.Point) {\r\n        let game = this.phaserGame;\r\n\r\n        if (this.glowTween && this.glowTween.isRunning) {\r\n            this.glowTween.stop();\r\n        }\r\n\r\n        this.glowTween = game.add.tween(this.glow).to({ x: position.x, y: position.y }, 100, Phaser.Easing.Linear.None, true);\r\n        this.glowTween.onComplete.add(() => this.glowTween.stop(), this);\r\n    }\r\n    public moveTo(sprite: Phaser.Sprite, x: number, y: number, callback: () => void) {\r\n\r\n        let game = this.phaserGame;\r\n\r\n        if (this.tween && this.tween.isRunning) {\r\n            this.tween.stop();\r\n        }\r\n        this.tween = game.add.tween(sprite).to({ x: x, y: y - 32 }, 100, Phaser.Easing.Linear.None, true);\r\n        this.tween.onComplete.add(() => this.onComplete(sprite, callback), this);\r\n    }\r\n\r\n    public lookTo(sprite: Phaser.Sprite, animationLooking: string): void {\r\n        sprite.play(animationLooking);\r\n    }\r\n\r\n    private onComplete(sprite: Phaser.Sprite, callback: () => void) {\r\n        callback();\r\n    }\r\n\r\n    private getTopDownCameraPositionY(): number {\r\n        let game = this.phaserGame,\r\n            camera = game.camera;\r\n        return (camera.bounds.bottom) - (camera.height / 2)\r\n    }\r\n\r\n    public addGroup(groupName) {\r\n        return this.phaserGame.add.group(this.phaserGame.world, groupName, false, true, Phaser.Physics.ARCADE);\r\n    }\r\n\r\n    private updateCamera() {\r\n        let game = this.phaserGame,\r\n            camera = game.camera,\r\n            activePointer = game.input.activePointer,\r\n            cameraPosition = camera.position,\r\n            livezone = 32,\r\n            cameraStep = 16;\r\n\r\n        if (activePointer.x <= livezone) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x - cameraStep, cameraPosition.y);\r\n        }\r\n        else if (activePointer.y <= livezone) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x, cameraPosition.y - cameraStep);\r\n        }\r\n        else if (activePointer.x >= camera.width - livezone) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x + cameraStep, cameraPosition.y);\r\n        }\r\n        else if (activePointer.y >= camera.height - livezone) {\r\n            let max = Math.min(cameraPosition.y + cameraStep, this.getTopDownCameraPositionY());\r\n            this.phaserGame.camera.setPosition(cameraPosition.x, max);\r\n        }\r\n    }\r\n\r\n    public isPositionCollidable(position: Phaser.Point): boolean {\r\n        let tile = this.getTileAtPosition(position);\r\n        return (tile && tile.properties.cantGo);\r\n    }\r\n\r\n    public getPositionCover(position: Phaser.Point): number {\r\n        let tile = this.getTileAtPosition(position);\r\n        return tile && tile.properties.cover ? tile.properties.cover : 0;\r\n    }\r\n    public getPositionMask(position: Phaser.Point): boolean {\r\n        let tile = this.getTileAtPosition(position);\r\n        return tile && tile.properties.mask ? true : false;\r\n    }\r\n\r\n    private getTileAtPosition(position: Phaser.Point): Phaser.Tile {\r\n        return this.map.getTileWorldXY(position.x, position.y, 16, 16, this.collisionLayer);\r\n    }\r\n\r\n    private overTimer: eventTimer = {\r\n        key: '',\r\n        time: -1,\r\n        tick: false,\r\n        wasOver: false\r\n    }\r\n\r\n    private setMarker() {\r\n        let marker: Phaser.Sprite = this.marker,\r\n            tilePointBelowPointer: Phaser.Point = this.pointToTilePosition(); // get tile coordinate below activePointer\r\n\r\n        if (this.isPositionCollidable(tilePointBelowPointer)) {\r\n            // do something if you want\r\n        } else {\r\n            marker.x = tilePointBelowPointer.x;\r\n            marker.y = tilePointBelowPointer.y;\r\n            let key = (marker.x / 32) + ':' + (marker.y / 32),\r\n                timestamp = new Date().getTime();\r\n            let duration = timestamp - this.overTimer.time;\r\n\r\n            if (this.overTimer.key == key) {\r\n                if (duration > 300) {\r\n                    if (!this.overTimer.tick) {\r\n                        this.overListener();\r\n                        this.overTimer.tick = true;\r\n                        this.overTimer.wasOver = true;\r\n                        if (this.debug) {\r\n                            this.text.destroy();\r\n                            this.text = this.phaserGame.add.text(marker.x, marker.y, key, null);\r\n\r\n                            this.text.font = 'Roboto';\r\n                            this.text.fontSize = 12;\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.text.destroy();\r\n                    this.overTimer.tick = false;\r\n                }\r\n            } else {\r\n                this.text.destroy();\r\n                this.overTimer.key = key;\r\n                this.overTimer.time = timestamp;\r\n                this.overTimer.tick = false;\r\n                if (this.overTimer.wasOver) {\r\n                    this.overOffListener();\r\n                    this.overTimer.wasOver = false;\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    public showText(x: number, y: number, text: string) {\r\n        if (this.xptext) {\r\n            this.xptext.destroy();\r\n        }\r\n        this.xptext = this.phaserGame.add.text(x, y, text, null);\r\n\r\n        this.xptext.font = 'Roboto';\r\n        this.xptext.fontSize = 12;\r\n    }\r\n\r\n    private pointToTilePosition(): Phaser.Point {\r\n        let game = this.phaserGame,\r\n            camera = game.camera,\r\n            activePointer = game.input.activePointer,\r\n            cameraPosition = camera.position,\r\n            tilesetSize = 32,\r\n            point = new Phaser.Point();\r\n        point.x = tilesetSize * Math.round((activePointer.x + cameraPosition.x - 16) / tilesetSize);\r\n        point.y = tilesetSize * Math.round((activePointer.y + cameraPosition.y - 16) / tilesetSize);\r\n        return point;\r\n    }\r\n    private handlerKeyBoard() {\r\n        let camera = this.phaserGame.camera,\r\n            cameraPosition = camera.position;\r\n        let noDirectionPressedflag = true;\r\n        if (this.wasd.cameraDown.isDown) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x, cameraPosition.y + 5);\r\n        }\r\n        if (this.wasd.cameraLeft.isDown) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x - 5, cameraPosition.y);\r\n        }\r\n        if (this.wasd.cameraRight.isDown) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x + 5, cameraPosition.y);\r\n        }\r\n        if (this.wasd.cameraUp.isDown) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x, cameraPosition.y - 5);\r\n        }\r\n        if (this.wasd.topTown.isDown) {\r\n            this.phaserGame.camera.setPosition(cameraPosition.x, (camera.bounds.bottom) - (camera.height / 2));\r\n        }\r\n\r\n        if (noDirectionPressedflag) {\r\n            //this.player.body.velocity.set(0);\r\n        }\r\n    }\r\n\r\n    update() {\r\n        this.setMarker();\r\n        this.updateCamera();\r\n        this.handlerKeyBoard();\r\n\r\n\r\n    }\r\n}\r\n\r\ninterface eventTimer {\r\n    key: string\r\n    time: number\r\n    tick: boolean\r\n    wasOver: boolean\r\n} \r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/phaser/engine.ts","import { Spawnable } from 'app/phaser/spawnable'\r\n\r\nexport class Pool extends Phaser.Group {\r\n\r\n    public sprites: Array<Phaser.Sprite>;\r\n\r\n    constructor(game: Phaser.Game, private spriteType: typeof Spawnable, instances: number, name: string) {\r\n        super(game, game.world, name, false, true, Phaser.Physics.ARCADE);\r\n        this.initializePool(instances);\r\n    }\r\n\r\n    private initializePool(instances) {\r\n        this.sprites = new Array();\r\n        if (instances <= 0) {\r\n            return;\r\n        } // We don't need to add anything to the group\r\n        for (var i = 0; i < instances; i++) {\r\n            let sprite = this.add(new this.spriteType(this.game)); // Add new sprite\r\n            sprite.poolId = i;\r\n            this.sprites.push(sprite);\r\n        }\r\n    }\r\n\r\n    public createNew(x: number, y: number, data?: Object) {\r\n        let obj: Spawnable = this.getFirstDead(false);\r\n        if (!obj) {\r\n            console.log('createNew');\r\n            obj = new this.spriteType(this.game);\r\n            this.add(obj, true);\r\n        }\r\n        obj.spawn(x, y, data);\r\n        return obj;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/phaser/pool.ts","\r\nexport class Spawnable extends Phaser.Sprite {\r\n\r\n    data:Object\r\n\r\n    constructor(game: Phaser.Game, x?: number, y?: number, texture?: string) {\r\n        super(game, x, y, texture);\r\n    }\r\n\r\n    spawn(x: number, y: number, data?: any) {\r\n        this.reset(x, y);\r\n        this.data = data;\r\n        this.exists = true;\r\n        this.alive = true;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/phaser/spawnable.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/environments/environment.ts","exports = module.exports = require(\"./../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".game__canvas__background{\\r\\n    position: relative;\\r\\n}\\r\\n.game__canvas__sprites{\\r\\n    position: absolute;\\r\\n    top: 0;\\r\\n    left: 0;\\r\\n}\\r\\n.game__canvas__background,\\r\\n.game__canvas__sprites{\\r\\n     -webkit-transform: translateZ(0);\\r\\n     transform: translateZ(0);\\r\\n}\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.css\n// module id = 473\n// module chunks = 1","module.exports = \"<div style=\\\"position: relative\\\">\\r\\n    <div id=\\\"game\\\" class=\\\"game__canvas__sprites\\\"></div>\\r\\n</div>\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.html\n// module id = 477\n// module chunks = 1"],"sourceRoot":""}